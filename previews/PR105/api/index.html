<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API ¬∑ LegendSpecFits</title><meta name="title" content="API ¬∑ LegendSpecFits"/><meta property="og:title" content="API ¬∑ LegendSpecFits"/><meta property="twitter:title" content="API ¬∑ LegendSpecFits"/><meta name="description" content="Documentation for LegendSpecFits."/><meta property="og:description" content="Documentation for LegendSpecFits."/><meta property="twitter:description" content="Documentation for LegendSpecFits."/><meta property="og:url" content="https://legend-exp.github.io/LegendSpecFits.jl/stable/api/"/><meta property="twitter:url" content="https://legend-exp.github.io/LegendSpecFits.jl/stable/api/"/><link rel="canonical" href="https://legend-exp.github.io/LegendSpecFits.jl/stable/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LegendSpecFits</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Modules"><span>Modules</span></a></li><li><a class="tocitem" href="#Types-and-constants"><span>Types and constants</span></a></li><li><a class="tocitem" href="#Functions-and-macros"><span>Functions and macros</span></a></li><li class="toplevel"><a class="tocitem" href="#Documentation"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/legend-exp/LegendSpecFits.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Modules"><a class="docs-heading-anchor" href="#Modules">Modules</a><a id="Modules-1"></a><a class="docs-heading-anchor-permalink" href="#Modules" title="Permalink"></a></h2><ul><li><a href="#LegendSpecFits.LegendSpecFits"><code>LegendSpecFits.LegendSpecFits</code></a></li></ul><h2 id="Types-and-constants"><a class="docs-heading-anchor" href="#Types-and-constants">Types and constants</a><a id="Types-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Types-and-constants" title="Permalink"></a></h2><ul></ul><h2 id="Functions-and-macros"><a class="docs-heading-anchor" href="#Functions-and-macros">Functions and macros</a><a id="Functions-and-macros-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-macros" title="Permalink"></a></h2><ul><li><a href="#LegendSpecFits.LQ_cut-Tuple{Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Vector{&lt;:Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}, Vector{&lt;:AbstractFloat}}"><code>LegendSpecFits.LQ_cut</code></a></li><li><a href="#LegendSpecFits._fit_fwhm_ft-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}} where T&lt;:Real"><code>LegendSpecFits._fit_fwhm_ft</code></a></li><li><a href="#LegendSpecFits._fit_fwhm_ft_ctc-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}} where T&lt;:Real"><code>LegendSpecFits._fit_fwhm_ft_ctc</code></a></li><li><a href="#LegendSpecFits._get_model_counts-Tuple{Union{Function, Type}, Union{NamedTuple, AbstractVector}, Union{StepRangeLen, Vector{&lt;:Real}}, Union{StepRangeLen, Vector{&lt;:Real}}}"><code>LegendSpecFits._get_model_counts</code></a></li><li><a href="#LegendSpecFits._prepare_data-Tuple{StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits._prepare_data</code></a></li><li><a href="#LegendSpecFits.advanced_time_and_memory_control-Tuple{}"><code>LegendSpecFits.advanced_time_and_memory_control</code></a></li><li><a href="#LegendSpecFits.aoe_compton_background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.aoe_compton_background_peakshape</code></a></li><li><a href="#LegendSpecFits.aoe_compton_peakshape-NTuple{6, Real}"><code>LegendSpecFits.aoe_compton_peakshape</code></a></li><li><a href="#LegendSpecFits.aoe_compton_peakshape_components-Tuple{Symbol}"><code>LegendSpecFits.aoe_compton_peakshape_components</code></a></li><li><a href="#LegendSpecFits.aoe_compton_signal_peakshape-NTuple{4, Real}"><code>LegendSpecFits.aoe_compton_signal_peakshape</code></a></li><li><a href="#LegendSpecFits.array_to_tuple-Tuple{AbstractArray, NamedTuple}"><code>LegendSpecFits.array_to_tuple</code></a></li><li><a href="#LegendSpecFits.autocal_energy-Tuple{AbstractArray{&lt;:Real}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}}"><code>LegendSpecFits.autocal_energy</code></a></li><li><a href="#LegendSpecFits.background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.background_peakshape</code></a></li><li><a href="#LegendSpecFits.baseline_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.baseline_qc</code></a></li><li><a href="#LegendSpecFits.chi2fit-Tuple{Function, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>LegendSpecFits.chi2fit</code></a></li><li><a href="#LegendSpecFits.ctc_energy"><code>LegendSpecFits.ctc_energy</code></a></li><li><a href="#LegendSpecFits.cut_single_peak-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, T, T}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.cut_single_peak</code></a></li><li><a href="#LegendSpecFits.double_gaussian-NTuple{7, Real}"><code>LegendSpecFits.double_gaussian</code></a></li><li><a href="#LegendSpecFits.estimate_combined_peak_stats-Tuple{StructArrays.StructArray}"><code>LegendSpecFits.estimate_combined_peak_stats</code></a></li><li><a href="#LegendSpecFits.estimate_fwhm-Tuple{NamedTuple}"><code>LegendSpecFits.estimate_fwhm</code></a></li><li><a href="#LegendSpecFits.estimate_single_peak_stats-Tuple"><code>LegendSpecFits.estimate_single_peak_stats</code></a></li><li><a href="#LegendSpecFits.ex_gauss_pdf-NTuple{4, Real}"><code>LegendSpecFits.ex_gauss_pdf</code></a></li><li><a href="#LegendSpecFits.ex_step_gauss-NTuple{5, Real}"><code>LegendSpecFits.ex_step_gauss</code></a></li><li><a href="#LegendSpecFits.expand_vars-Tuple{NamedTuple}"><code>LegendSpecFits.expand_vars</code></a></li><li><a href="#LegendSpecFits.exponential_decay-NTuple{4, Real}"><code>LegendSpecFits.exponential_decay</code></a></li><li><a href="#LegendSpecFits.fit_aoe_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s414&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_aoe_compton</code></a></li><li><a href="#LegendSpecFits.fit_aoe_compton_combined-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s389&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s389&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s389&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_aoe_compton_combined</code></a></li><li><a href="#LegendSpecFits.fit_aoe_corrections-Tuple{Array{&lt;:Union{Unitful.Quantity{var&quot;#s392&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s392&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s392&quot;&lt;:Real, U}}, Array{&lt;:Real}, Array{&lt;:Real}}"><code>LegendSpecFits.fit_aoe_corrections</code></a></li><li><a href="#LegendSpecFits.fit_binned_double_gauss-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_binned_double_gauss</code></a></li><li><a href="#LegendSpecFits.fit_binned_trunc_gauss-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_binned_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_calibration-Tuple{Int64, AbstractVector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, AbstractVector{&lt;:Unitful.Quantity}}"><code>LegendSpecFits.fit_calibration</code></a></li><li><a href="#LegendSpecFits.fit_enc_sigmas-Union{Tuple{T}, Tuple{Matrix{T}, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, T, T, Int64, T}} where T&lt;:Real"><code>LegendSpecFits.fit_enc_sigmas</code></a></li><li><a href="#LegendSpecFits.fit_fwhm"><code>LegendSpecFits.fit_fwhm</code></a></li><li><a href="#LegendSpecFits.fit_fwhm_ft-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T, Bool}} where T&lt;:Real"><code>LegendSpecFits.fit_fwhm_ft</code></a></li><li><a href="#LegendSpecFits.fit_half_centered_trunc_gauss-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, T, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_centered_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_half_trunc_gauss-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_lq_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s4235&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4235&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4235&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_lq_compton</code></a></li><li><a href="#LegendSpecFits.fit_peaks-Tuple{Array, StructArrays.StructArray, Vector}"><code>LegendSpecFits.fit_peaks</code></a></li><li><a href="#LegendSpecFits.fit_peaks_combined-Tuple{Array, StructArrays.StructArray, Array}"><code>LegendSpecFits.fit_peaks_combined</code></a></li><li><a href="#LegendSpecFits.fit_sf_wl-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, ArraysOfArrays.ArrayOfSimilarArrays{var&quot;#s4213&quot;, M, N, L, P} where {var&quot;#s4213&quot;&lt;:Real, M, N, L, P&lt;:AbstractArray{var&quot;#s4213&quot;, L}}, Vector{&lt;:Real}, ArraysOfArrays.ArrayOfSimilarArrays{var&quot;#s4211&quot;, M, N, L, P} where {var&quot;#s4211&quot;&lt;:Real, M, N, L, P&lt;:AbstractArray{var&quot;#s4211&quot;, L}}, StepRangeLen}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s4215&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4215&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4215&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_sf_wl</code></a></li><li><a href="#LegendSpecFits.fit_single_aoe_compton-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_single_aoe_compton</code></a></li><li><a href="#LegendSpecFits.fit_single_aoe_compton_with_fixed_Œº_and_œÉ-Tuple{StatsBase.Histogram, Number, Number, NamedTuple}"><code>LegendSpecFits.fit_single_aoe_compton_with_fixed_Œº_and_œÉ</code></a></li><li><a href="#LegendSpecFits.fit_single_lq_compton-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_single_lq_compton</code></a></li><li><a href="#LegendSpecFits.fit_single_peak_th228-Union{Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, bin_width::T, mean_background::T, mean_background_step::T, mean_background_std::T}}} where T&lt;:Real"><code>LegendSpecFits.fit_single_peak_th228</code></a></li><li><a href="#LegendSpecFits.fit_single_trunc_gauss-Union{Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}}, Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_single_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_sipm_spectrum"><code>LegendSpecFits.fit_sipm_spectrum</code></a></li><li><a href="#LegendSpecFits.fit_subpeaks_th228-Tuple{StatsBase.Histogram, StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_subpeaks_th228</code></a></li><li><a href="#LegendSpecFits.gamma_peakshape-NTuple{8, Real}"><code>LegendSpecFits.gamma_peakshape</code></a></li><li><a href="#LegendSpecFits.gauss_pdf-Tuple{Real, Real, Real}"><code>LegendSpecFits.gauss_pdf</code></a></li><li><a href="#LegendSpecFits.generate_aoe_compton_bands-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, Vector{&lt;:T}, Vector{&lt;:T}, T}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s2692&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s2692&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s2692&quot;&lt;:Real, U})"><code>LegendSpecFits.generate_aoe_compton_bands</code></a></li><li><a href="#LegendSpecFits.get_centered_gaussian_window_cut-Union{Tuple{T}, Tuple{Vector{T}, T, T, Real}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.get_centered_gaussian_window_cut</code></a></li><li><a href="#LegendSpecFits.get_continuum_survival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, T, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s516&quot;&lt;:Real, U})"><code>LegendSpecFits.get_continuum_survival_fraction</code></a></li><li><a href="#LegendSpecFits.get_distribution_transform"><code>LegendSpecFits.get_distribution_transform</code></a></li><li><a href="#LegendSpecFits.get_friedman_diaconis_bin_width"><code>LegendSpecFits.get_friedman_diaconis_bin_width</code></a></li><li><a href="#LegendSpecFits.get_low_aoe_cut-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s385&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s385&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s385&quot;&lt;:Real, U})"><code>LegendSpecFits.get_low_aoe_cut</code></a></li><li><a href="#LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, NamedTuple, Integer}"><code>LegendSpecFits.get_mc_value_shapes</code></a></li><li><a href="#LegendSpecFits.get_mc_value_shapes-Union{Tuple{T}, Tuple{V}, Tuple{V, Matrix{T}, Integer}} where {V&lt;:NamedTuple, T&lt;:AbstractFloat}"><code>LegendSpecFits.get_mc_value_shapes</code></a></li><li><a href="#LegendSpecFits.get_number_of_bins-Tuple{AbstractArray}"><code>LegendSpecFits.get_number_of_bins</code></a></li><li><a href="#LegendSpecFits.get_peak_fwhm_th228"><code>LegendSpecFits.get_peak_fwhm_th228</code></a></li><li><a href="#LegendSpecFits.get_peak_survival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s414&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peak_survival_fraction</code></a></li><li><a href="#LegendSpecFits.get_peakhists_th228-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s240&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s240&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s240&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s199&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s199&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s199&quot;&lt;:Real, U}}, Vector{&lt;:Tuple{Union{Unitful.Quantity{var&quot;#s197&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s197&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s197&quot;&lt;:Real, U}, Union{Unitful.Quantity{var&quot;#s27&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s27&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s27&quot;&lt;:Real, U}}}}"><code>LegendSpecFits.get_peakhists_th228</code></a></li><li><a href="#LegendSpecFits.get_peaks_survival_fractions-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, Vector{&lt;:T}, Vector{Symbol}, Vector{&lt;:Tuple{T, T}}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s386&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s386&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s386&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peaks_survival_fractions</code></a></li><li><a href="#LegendSpecFits.get_residuals-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}"><code>LegendSpecFits.get_residuals</code></a></li><li><a href="#LegendSpecFits.get_sf_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s516&quot;&lt;:Real, U})"><code>LegendSpecFits.get_sf_after_aoe_cut</code></a></li><li><a href="#LegendSpecFits.get_th228_fit_functions-Tuple{}"><code>LegendSpecFits.get_th228_fit_functions</code></a></li><li><a href="#LegendSpecFits.highEtail_peakshape-NTuple{6, Real}"><code>LegendSpecFits.highEtail_peakshape</code></a></li><li><a href="#LegendSpecFits.hist_loglike-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits.hist_loglike</code></a></li><li><a href="#LegendSpecFits.linear_function-Tuple{Real, Real, Real}"><code>LegendSpecFits.linear_function</code></a></li><li><a href="#LegendSpecFits.lowEtail_peakshape-NTuple{6, Real}"><code>LegendSpecFits.lowEtail_peakshape</code></a></li><li><a href="#LegendSpecFits.lq_drift_time_correction-Tuple{Vector{&lt;:AbstractFloat}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s4225&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4225&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4225&quot;&lt;:Real, U}}, Unitful.AbstractQuantity, Unitful.AbstractQuantity}"><code>LegendSpecFits.lq_drift_time_correction</code></a></li><li><a href="#LegendSpecFits.nearestSPD-Tuple{Matrix{&lt;:Real}}"><code>LegendSpecFits.nearestSPD</code></a></li><li><a href="#LegendSpecFits.p_value-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}"><code>LegendSpecFits.p_value</code></a></li><li><a href="#LegendSpecFits.p_value_MC-Union{Tuple{T}, Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, mean_background::T, mean_background_step::T, mean_background_std::T}, NamedTuple}} where T&lt;:Real"><code>LegendSpecFits.p_value_MC</code></a></li><li><a href="#LegendSpecFits.p_value_poissonll-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}"><code>LegendSpecFits.p_value_poissonll</code></a></li><li><a href="#LegendSpecFits.peak_centroid-Tuple{NamedTuple}"><code>LegendSpecFits.peak_centroid</code></a></li><li><a href="#LegendSpecFits.peakshape_components-Tuple{Symbol}"><code>LegendSpecFits.peakshape_components</code></a></li><li><a href="#LegendSpecFits.prepare_sep_peakhist-Union{Tuple{Vector{&lt;:T}}, Tuple{T}} where T&lt;:Real"><code>LegendSpecFits.prepare_sep_peakhist</code></a></li><li><a href="#LegendSpecFits.pulser_cal_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.pulser_cal_qc</code></a></li><li><a href="#LegendSpecFits.set_memlimit-Tuple{Float64}"><code>LegendSpecFits.set_memlimit</code></a></li><li><a href="#LegendSpecFits.set_timelimit-Tuple{Float64}"><code>LegendSpecFits.set_timelimit</code></a></li><li><a href="#LegendSpecFits.signal_peakshape-NTuple{5, Real}"><code>LegendSpecFits.signal_peakshape</code></a></li><li><a href="#LegendSpecFits.simple_calibration"><code>LegendSpecFits.simple_calibration</code></a></li><li><a href="#LegendSpecFits.sipm_simple_calibration"><code>LegendSpecFits.sipm_simple_calibration</code></a></li><li><a href="#LegendSpecFits.step_gauss-Tuple{Real, Real, Real}"><code>LegendSpecFits.step_gauss</code></a></li><li><a href="#LegendSpecFits.subhist-Tuple{StatsBase.Histogram{&lt;:Any, 1}, Tuple{Real, Real}}"><code>LegendSpecFits.subhist</code></a></li><li><a href="#LegendSpecFits.tuple_to_array-Tuple{NamedTuple}"><code>LegendSpecFits.tuple_to_array</code></a></li><li><a href="#LegendSpecFits.weibull_from_mx"><code>LegendSpecFits.weibull_from_mx</code></a></li></ul><h1 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.LegendSpecFits" href="#LegendSpecFits.LegendSpecFits"><code>LegendSpecFits.LegendSpecFits</code></a> ‚Äî <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendSpecFits</code></pre><p>Template for Julia packages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/LegendSpecFits.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.LQ_cut-Tuple{Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Vector{&lt;:Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}, Vector{&lt;:AbstractFloat}}" href="#LegendSpecFits.LQ_cut-Tuple{Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Vector{&lt;:Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}, Vector{&lt;:AbstractFloat}}"><code>LegendSpecFits.LQ_cut</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DEP_¬µ::Unitful.Energy, DEP_œÉ::Unitful.Energy, e_cal::Vector{&lt;:Unitful.Energy}, lq_classifier::Vector{Float64}; cut_sigma::Float64=3.0, truncation_sigma::Float64=2.0)</code></pre><p>Evaluates the cutoff value for the LQ cut. The function performs a binned gaussian fit on the sidebandsubtracted LQ histogram and evaluates the cutoff value difined at 3œÉ of the fit.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the cutoff value
* `report`: NamedTuple of the fit result, fit report and temporary histograms</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/lqcut.jl#L132-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits._fit_fwhm_ft-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}} where T&lt;:Real" href="#LegendSpecFits._fit_fwhm_ft-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}} where T&lt;:Real"><code>LegendSpecFits._fit_fwhm_ft</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fit_fwhm_ft(e_grid::Matrix, e_grid_ft::StepRangeLen{Quantity{&lt;:T}, Base.TwicePrecision{Quantity{&lt;:T}}, Base.TwicePrecision{Quantity{&lt;:T}}, Int64}, rt::Unitful.RealOrRealQuantity, min_e::T, max_e::T, nbins::Int64, rel_cut_fit::T; default_ft::Quantity{T}=3.0u&quot;¬µs&quot;, ft_fwhm_tol::Unitful.Energy{&lt;:Real} = 0.1u&quot;keV&quot;) where {T &lt;:Real}</code></pre><p>Fit the FWHM values in <code>e_grid</code> for each FT in <code>e_grid_ft</code> with a Gamma Peakshape and return the optimal FT and the corresponding FWHM value. The cut values cut for each flat-top time a window for better histogramming.</p><p><strong>Arguments</strong></p><ul><li><code>e_grid</code>: 2D array of energy values for each FT in <code>e_grid_ft</code></li><li><code>e_grid_ft</code>: 1D array of FT values for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>rt</code>: RT value for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>min_e</code>: minimum energy value to consider for the fit</li><li><code>max_e</code>: maximum energy value to consider for the fit</li><li><code>nbins</code>: number of bins to use for the histogram of energy values</li><li><code>rel_cut_fit</code>: relative cut value to use for the fit</li><li><code>ft_fwhm_tol</code>: search for lowest &quot;optimal&quot; ft within <code>minimum(fwhm) + ft_fwhm_tol</code> to avoid artificially large ft </li></ul><p><strong>Returns</strong></p><ul><li><code>ft</code>: optimal FT value</li><li><code>min_fwhm</code>: corresponding FWHM value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/filter_optimization.jl#L108-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits._fit_fwhm_ft_ctc-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}} where T&lt;:Real" href="#LegendSpecFits._fit_fwhm_ft_ctc-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}} where T&lt;:Real"><code>LegendSpecFits._fit_fwhm_ft_ctc</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fit_fwhm_ft_ctc(e_grid::Matrix, e_grid_ft::StepRangeLen, qdrift::Vector{&lt;:Real}, rt::Unitful.RealOrRealQuantity, min_e::T, max_e::T, nbins::Int64, rel_cut_fit::T; default_ft::Quantity{T}=3.0u&quot;¬µs&quot;, peak::Unitful.Energy{&lt;:Real}=2614.5u&quot;keV&quot;, window::Tuple{&lt;:Unitful.Energy{&lt;:Real}, &lt;:Unitful.Energy{&lt;:Real}}=(35.0u&quot;keV&quot;, 25.0u&quot;keV&quot;), ft_fwhm_tol::Unitful.Energy{&lt;:Real} = 0.1u&quot;keV&quot;) where {T &lt;:Real}</code></pre><p>Fit the FWHM values in <code>e_grid</code> for each FT in <code>e_grid_ft</code> with a Gamma Peakshape and return the optimal FT and the corresponding FWHM value. The cut values cut for each flat-top time a window for better histogramming.</p><p><strong>Arguments</strong></p><ul><li><code>e_grid</code>: 2D array of energy values for each FT in <code>e_grid_ft</code></li><li><code>e_grid_ft</code>: 1D array of FT values for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>qdrift</code>: drift time values for each energy value in <code>e_grid</code></li><li><code>rt</code>: RT value for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>min_e</code>: minimum energy value to consider for the fit</li><li><code>max_e</code>: maximum energy value to consider for the fit</li><li><code>nbins</code>: number of bins to use for the histogram of energy values</li><li><code>rel_cut_fit</code>: relative cut value to use for the fit</li><li><code>ft_fwhm_tol</code>: search for lowest &quot;optimal&quot; ft within <code>minimum(fwhm) + ft_fwhm_tol</code> to avoid artificially large ft </li></ul><p><strong>Returns</strong></p><ul><li><code>ft</code>: optimal FT value</li><li><code>min_fwhm</code>: corresponding FWHM value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/filter_optimization.jl#L215-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits._get_model_counts-Tuple{Union{Function, Type}, Union{NamedTuple, AbstractVector}, Union{StepRangeLen, Vector{&lt;:Real}}, Union{StepRangeLen, Vector{&lt;:Real}}}" href="#LegendSpecFits._get_model_counts-Tuple{Union{Function, Type}, Union{NamedTuple, AbstractVector}, Union{StepRangeLen, Vector{&lt;:Real}}, Union{StepRangeLen, Vector{&lt;:Real}}}"><code>LegendSpecFits._get_model_counts</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_get_model_counts(f_fit::Base.Callable,v_ml::Union{NamedTuple, AbstractVector},bin_centers::StepRangeLen,bin_widths::StepRangeLen)</code></pre><p>aux. function to get modelled peakshape based on  histogram binning and best-fit parameter</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/gof.jl#L18-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits._prepare_data-Tuple{StatsBase.Histogram{&lt;:Real, 1}}" href="#LegendSpecFits._prepare_data-Tuple{StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits._prepare_data</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_prepare_data(h::Histogram{&lt;:Real,1})</code></pre><p>aux. function to convert histogram data into bin edges, bin width and bin counts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/gof.jl#L4-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.advanced_time_and_memory_control-Tuple{}" href="#LegendSpecFits.advanced_time_and_memory_control-Tuple{}"><code>LegendSpecFits.advanced_time_and_memory_control</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advanced_time_and_memory_control(x::Optim.OptimizationState, start_time::Float64, time_to_setup::Float64; time_limit::Float64=60.0, mem_limit::Float64=30.0)

Control function to stop optimization based on time and memory usage.</code></pre><p><strong>Arguments</strong></p><ul><li><code>x::Optim.OptimizationState</code>: optimization state</li><li><code>start_time::Float64</code>: start time</li><li><code>time_to_setup::Float64</code>: time to setup</li><li><code>time_limit::Float64</code>: time limit</li><li><code>mem_limit::Float64</code>: memory limit</li></ul><p><strong>Return</strong></p><ul><li><code>Bool</code>: true if optimization should stop</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/memory_utils.jl#L23-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_background_peakshape-NTuple{5, Real}" href="#LegendSpecFits.aoe_compton_background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.aoe_compton_background_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aoe_compton_background_peakshape(
    x::Real, Œº::Real, œÉ::Real,
    background::Real, Œ¥::Real
)</code></pre><p>Describes the background shape of a typical A/E Compton peak in a detector as a step like background for MSE events.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L221-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_peakshape-NTuple{6, Real}" href="#LegendSpecFits.aoe_compton_peakshape-NTuple{6, Real}"><code>LegendSpecFits.aoe_compton_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aoe_compton_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    background::Real, Œ¥::Real
)</code></pre><p>Describes the shape of a typical A/E Compton peak in a detector as a gaussian SSE peak and a step like background for MSE events.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L190-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_peakshape_components-Tuple{Symbol}" href="#LegendSpecFits.aoe_compton_peakshape_components-Tuple{Symbol}"><code>LegendSpecFits.aoe_compton_peakshape_components</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aoe_compton_peakshape_components(fit_func::Symbol; background_center::Real)</code></pre><p>This function defines the components (signal, low/high-energy tail, backgrounds) of the fit function used in gamma specfits.  These component functions are used in the fit-report and in plot receipes </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoefit_functions.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_signal_peakshape-NTuple{4, Real}" href="#LegendSpecFits.aoe_compton_signal_peakshape-NTuple{4, Real}"><code>LegendSpecFits.aoe_compton_signal_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aoe_compton_signal_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real
)</code></pre><p>Describes the signal shape of a typical A/E Compton peak in a detector as a gaussian SSE peak.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L207-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.array_to_tuple-Tuple{AbstractArray, NamedTuple}" href="#LegendSpecFits.array_to_tuple-Tuple{AbstractArray, NamedTuple}"><code>LegendSpecFits.array_to_tuple</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">array_to_tuple(a::AbstractArray, as_nt::NamedTuple)</code></pre><p>Return a <code>NamedTuple</code> with the values of <code>a</code> in the order given by <code>fieldnames(as_nt)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L58-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.autocal_energy-Tuple{AbstractArray{&lt;:Real}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}}" href="#LegendSpecFits.autocal_energy-Tuple{AbstractArray{&lt;:Real}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}}"><code>LegendSpecFits.autocal_energy</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">autocal_energy(e::AbstractArray{&lt;:Real}, photon_lines::Vector{&lt;:Unitful.RealOrRealQuantity}; min_e::Real=100, max_e_binning_quantile::Real=0.5, œÉ::Real = 2.0, threshold::Real = 50.0, min_n_peaks::Int = length(photon_lines), max_n_peaks::Int = 4 * length(photon_lines), Œ±::Real = 0.01, rtol::Real = 5e-3)</code></pre><p>Compute an energy calibration from raw reconstructed energy deposition values based on a given number of known photon lines which are contained in the spectrum</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/auto_calibration.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.background_peakshape-NTuple{5, Real}" href="#LegendSpecFits.background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.background_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">background_peakshape(
x::Real, Œº::Real, œÉ::Real, 
step_amplitude::Real, background::Real; 
background_slope::Real = 0.0, background_exp = 0.0, background_center::Real = ¬µ</code></pre><p>)</p><p>Describes the background part of the shape of a typical gamma peak in a detector:  components: </p><ul><li>step-function scaled with <code>step_amplitude</code>`</li><li>energy-independent background: <code>background</code>`</li><li>linear slope: <code>background_slope</code> (optional)</li><li>exponential decay:  <code>background_exp</code> (optional)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L121-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.baseline_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table" href="#LegendSpecFits.baseline_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.baseline_qc</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">baseline_qc(data, qc_config)</code></pre><p>Perform simple Gaussian fits on the baseline disitrbutions for a given data set.</p><p><strong>Returns</strong></p><ul><li><code>result</code>: Namedtuple containing the cut and fit results for each baseline variable</li><li><code>report</code>: Namedtuple containing plotable objects.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/qc.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.chi2fit-Tuple{Function, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}" href="#LegendSpecFits.chi2fit-Tuple{Function, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>LegendSpecFits.chi2fit</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_chisq(x::AbstractVector{&lt;:Real},y::AbstractVector{&lt;:Real},yerr::AbstractVector{&lt;:Real}, f_fit::Function;pull_t::Vector{&lt;:NamedTuple} = fill(NamedTuple(), first(methods(f_fit)).nargs - 2), v_init::Vector = [])</code></pre><p>Least square fit with chi2 minimization</p><p><strong>Input:</strong></p><ul><li>x : x-values</li><li>y : y-values</li><li>yerr : 1 sigma uncertainty on y</li><li>f<em>fit : fit/model function. e.g. for a linear function: f</em>lin(x,p1,p2)  = p1 .* x .+ p2   </li></ul><p>The numer of fit parameter is determined with <code>first(methods(f_fit)).nargs - 2</code>. That&#39;s why it&#39;s important that f<em>fit has the synthax f(x,arg1,arg2,arg3,...) pull</em>t : pull term, a vector of NamedTuple with fields <code>mean</code> and <code>std</code>. A Gaussian pull term is added to the chi2 function to account for systematic uncertainties. If left blank, no pull term is used. v_init : initial value for fit parameter optimization. If left blank, the initial value is set to 1 or guessed roughly for all fit parameters</p><p><strong>Return:</strong></p><ul><li>result : NamedTuple with the optimized fit parameter and the fit function</li><li>report: </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/chi2fit.jl#L2-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.ctc_energy" href="#LegendSpecFits.ctc_energy"><code>LegendSpecFits.ctc_energy</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ctc_energy(e::Array{T}, qdrift::Array{T}, peak::T, window::T) where T&lt;:Real</code></pre><p>Correct for the drift time dependence of the energy by minimizing the ratio of the FWHM and the peak height of the peak around <code>peak</code> in <code>e</code> with a cut window of <code>window</code>. The drift time dependence is given by <code>qdrift</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peak`: peak position
* `window`: window size
* `fct`: correction factor
* `fwhm_before`: FWHM before correction
* `fwhm_after`: FWHM after correction
* `func`: function to correct energy
* `func_generic`: generic function to correct energy</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/ctc.jl#L2-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.cut_single_peak-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, T, T}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.cut_single_peak-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, T, T}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.cut_single_peak</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cut_single_peak(x::Array, min_x::Float64, max_x::Float64,; n_bins::Int=-1, relative_cut::Float64=0.5)</code></pre><p>Cut out a single peak from the array <code>x</code> between <code>min_x</code> and <code>max_x</code>. The number of bins is the number of bins to use for the histogram. The relative cut is the fraction of the maximum counts to use for the cut.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `max`: maximum position of the peak
* `low`: lower edge of the cut peak
* `high`: upper edge of the cut peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/simple_cuts.jl#L2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.double_gaussian-NTuple{7, Real}" href="#LegendSpecFits.double_gaussian-NTuple{7, Real}"><code>LegendSpecFits.double_gaussian</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">double_gaussian(
    x::Real, Œº1::Real, œÉ1::Real, n1::Real, 
    Œº2::Real, œÉ2::Real, n2::Real
)</code></pre><p>Evaluates the sum of two gaussians at <code>x</code> with parameters <code>Œº1</code>, <code>œÉ1</code>, <code>n1</code>, <code>Œº2</code>, <code>œÉ2</code>, <code>n2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L237-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_combined_peak_stats-Tuple{StructArrays.StructArray}" href="#LegendSpecFits.estimate_combined_peak_stats-Tuple{StructArrays.StructArray}"><code>LegendSpecFits.estimate_combined_peak_stats</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_combined_peak_stats(peakstats::StructArray,; calib_type::Symbol=:th228)</code></pre><p>Estimate the peak position, FWHM, sigma, counts and background of a peak from a histogram.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit_combined.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_fwhm-Tuple{NamedTuple}" href="#LegendSpecFits.estimate_fwhm-Tuple{NamedTuple}"><code>LegendSpecFits.estimate_fwhm</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_fwhm(v::NamedTuple, v_err::NamedTuple)</code></pre><p>Get the FWHM of a peak from the fit parameters.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `fwhm`: the FWHM of the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit.jl#L204-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_single_peak_stats-Tuple" href="#LegendSpecFits.estimate_single_peak_stats-Tuple"><code>LegendSpecFits.estimate_single_peak_stats</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_single_peak_stats(h::Histogram, calib_type::Symbol=:th228)</code></pre><p>Estimate statistics/parameters for a single peak in the given histogram <code>h</code>.</p><p><code>h</code> must only contain a single peak. The peak should have a Gaussian-like shape. <code>calib_type</code> specifies the calibration type. Currently <code>:th228</code>, <code>:psd</code> and <code>:simple</code> is implemented..</p><p><strong>Returns</strong></p><p><code>NamedTuple</code> with the fields     * <code>peak_pos</code>: estimated position of the peak (in the middle of the peak)     * <code>peak_fwhm</code>: full width at half maximum (FWHM) of the peak     * <code>peak_sigma</code>: estimated standard deviation of the peak     * <code>peak_counts</code>: estimated number of counts in the peak     * <code>mean_background</code>: estimated mean background value</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakstats.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.ex_gauss_pdf-NTuple{4, Real}" href="#LegendSpecFits.ex_gauss_pdf-NTuple{4, Real}"><code>LegendSpecFits.ex_gauss_pdf</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ex_gauss_pdf(x::Real, Œº::Real, œÉ::Real, Œ∏::Real)</code></pre><p>The PDF of an <a href="https://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution">Exponentially modified Gaussian distribution</a> with Gaussian parameters <code>Œº</code>, <code>œÉ</code> and exponential scale <code>Œ∏</code> at <code>x</code>.</p><p>It is the PDF of the distribution that descibes the random process <code>rand(Normal(Œº, œÉ)) + rand(Exponential(Œ∏))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L10-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.ex_step_gauss-NTuple{5, Real}" href="#LegendSpecFits.ex_step_gauss-NTuple{5, Real}"><code>LegendSpecFits.ex_step_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ex_step_gauss(x::Real, l::Real, k::Real, t::Real, d::Real)</code></pre><p>Evaluates an extended step gauss model at <code>x</code> with parameters <code>l</code>, <code>k</code>, <code>t</code> and <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L177-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.expand_vars-Tuple{NamedTuple}" href="#LegendSpecFits.expand_vars-Tuple{NamedTuple}"><code>LegendSpecFits.expand_vars</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">expand_vars(v::NamedTuple)::StructArray</code></pre><p>Expand all fields in <code>v</code> (scalars or arrays) to same array size and return a <code>StructArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.exponential_decay-NTuple{4, Real}" href="#LegendSpecFits.exponential_decay-NTuple{4, Real}"><code>LegendSpecFits.exponential_decay</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exponential_decay(x::Real, amplitude::Real, decay::Real, offset::Real)</code></pre><p>Evaluates an exponential decay function at <code>x</code> with parameters <code>amplitude</code>, <code>decay</code> and <code>offset</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L62-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_aoe_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s414&quot;&lt;:Real, U})" href="#LegendSpecFits.fit_aoe_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s414&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_aoe_compton</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_aoe_compton(peakhists::Array, peakstats::StructArray, compton_bands::Array{T}) where T&lt;:Real</code></pre><p>Fit the A/E Compton bands using the <code>f_aoe_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: Dict of NamedTuples of the fit results containing values and errors for each compton band
* `report`: Dict of NamedTuples of the fit report which can be plotted for each compton band</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoefit.jl#L111-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_aoe_compton_combined-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s389&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s389&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s389&quot;&lt;:Real, U})" href="#LegendSpecFits.fit_aoe_compton_combined-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s389&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s389&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s389&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_aoe_compton_combined</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_aoe_compton_combined(peakhists::Vector{&lt;:Histogram}, peakstats::StructArray, compton_bands::Array{T}, result_corrections::NamedTuple; pars_aoe::NamedTuple{(:Œº, :Œº_err, :œÉ, :œÉ_err)}=NamedTuple{(:Œº, :Œº_err, :œÉ, :œÉ_err)}(nothing, nothing, nothing, nothing), uncertainty::Bool=false) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Performed a combined fit over all A/E Compton band using the <code>f_aoe_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events, assuming <code>f_aoe_mu</code> for <code>Œº</code> and <code>f_aoe_sigma</code> for <code>œÉ</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `v_ml`: The fit result from the maximum-likelihood fit.
* `report_Œº`: Report to plot the combined fit result for the enery-dependence of `Œº`.
* `report_œÉ`: Report to plot the combined fit result for the enery-dependence of `œÉ`.
* `report_bands`: Dict of NamedTuples of the fit report which can be plotted for each compton band</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoefit_combined.jl#L143-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_aoe_corrections-Tuple{Array{&lt;:Union{Unitful.Quantity{var&quot;#s392&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s392&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s392&quot;&lt;:Real, U}}, Array{&lt;:Real}, Array{&lt;:Real}}" href="#LegendSpecFits.fit_aoe_corrections-Tuple{Array{&lt;:Union{Unitful.Quantity{var&quot;#s392&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s392&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s392&quot;&lt;:Real, U}}, Array{&lt;:Real}, Array{&lt;:Real}}"><code>LegendSpecFits.fit_aoe_corrections</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>fit<em>aoe</em>corrections(e::Array{&lt;:Unitful.Energy{&lt;:Real}}, Œº::Array{&lt;:Real}, œÉ::Array{&lt;:Real})</p><p>Fit the corrections for the AoE value of the detector.</p><p><strong>Returns</strong></p><ul><li><code>e</code>: Energy values</li><li><code>Œº</code>: Mean values</li><li><code>œÉ</code>: Sigma values</li><li><code>Œº_scs</code>: Fit result for the mean values</li><li><code>f_Œº_scs</code>: Fit function for the mean values</li><li><code>œÉ_scs</code>: Fit result for the sigma values</li><li><code>f_œÉ_scs</code>: Fit function for the sigma values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_fit_calibration.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_binned_double_gauss-Tuple{StatsBase.Histogram, NamedTuple}" href="#LegendSpecFits.fit_binned_double_gauss-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_binned_double_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_binned_double_gauss(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background, :Œº, :œÉ), NTuple{7, T}}; uncertainty::Bool=true) where T&lt;:Real</code></pre><p>Perform a binned fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>f_double_gauss</code> function consisting of a double gaussian peak. The priors for the first gaussian peak are given by the <code>ps</code> tuple. For the priors of the second gaussian peak a wide window around the first peak is used.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/singlefit.jl#L485-L494">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_binned_trunc_gauss-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_binned_trunc_gauss-Union{Tuple{StatsBase.Histogram}, Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_binned_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_binned_trunc_gauss(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background, :Œº, :œÉ), NTuple{7, T}}; uncertainty::Bool=true) where T&lt;:Real</code></pre><p>Perform a binned fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>f_gauss</code> function consisting of a gaussian peak multiplied with an amplitude n.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/singlefit.jl#L363-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_calibration-Tuple{Int64, AbstractVector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, AbstractVector{&lt;:Unitful.Quantity}}" href="#LegendSpecFits.fit_calibration-Tuple{Int64, AbstractVector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, AbstractVector{&lt;:Unitful.Quantity}}"><code>LegendSpecFits.fit_calibration</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_calibration(pol_order::Int, ¬µ::AbstractVector{&lt;:Union{Real,Measurement{&lt;:Real}}}, peaks::AbstractVector{&lt;:Union{Real,Measurement{&lt;:Real}}}; pull_t::Vector{&lt;:NamedTuple}=fill(NamedTuple(), pol_order+1), v_init::Vector = [], uncertainty::Bool=true )</code></pre><p>Fit the calibration lines with polynomial function of pol<em>order order     pol</em>order == 1 -&gt; linear function     pol_order == 2 -&gt; quadratic function</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple with the following fields
    * `par`: best-fit parameters
    * `gof`: godness of fit
* `report`:</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/fit_calibration.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_enc_sigmas-Union{Tuple{T}, Tuple{Matrix{T}, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, T, T, Int64, T}} where T&lt;:Real" href="#LegendSpecFits.fit_enc_sigmas-Union{Tuple{T}, Tuple{Matrix{T}, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, T, T, Int64, T}} where T&lt;:Real"><code>LegendSpecFits.fit_enc_sigmas</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_enc_sigmas(enc_grid::Matrix{T}, enc_grid_rt::StepRangeLen{Quantity{&lt;:T}, Base.TwicePrecision{Quantity{&lt;:T}}, Base.TwicePrecision{Quantity{&lt;:T}}, Int64}, min_enc::T, max_enc::T, nbins::Int64, rel_cut_fit::T) where T&lt;:Real</code></pre><p>Fit the ENC values in <code>enc_grid</code> for each RT in <code>enc_grid_rt</code> with a Gaussian and return the optimal RT and the corresponding ENC value.</p><p><strong>Arguments</strong></p><ul><li><code>enc_grid</code>: 2D array of ENC values for each RT in <code>enc_grid_rt</code></li><li><code>enc_grid_rt</code>: 1D array of RT values for which the ENC values in <code>enc_grid</code> are calculated</li><li><code>min_enc</code>: minimum ENC value to consider for the fit</li><li><code>max_enc</code>: maximum ENC value to consider for the fit</li><li><code>nbins</code>: number of bins to use for the histogram of ENC values</li><li><code>rel_cut_fit</code>: relative cut value to use for the fit</li></ul><p><strong>Returns</strong></p><ul><li><code>rt</code>: optimal RT value</li><li><code>min_enc</code>: corresponding ENC value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/filter_optimization.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_fwhm" href="#LegendSpecFits.fit_fwhm"><code>LegendSpecFits.fit_fwhm</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fitFWHM(fit_fwhm(peaks::Vector{T}, fwhm::Vector{T}) where T&lt;:Real</code></pre><p>Fit the FWHM of the peaks to a quadratic function.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `qbb`: the FWHM at 2039 keV
* `err`: the uncertainties of the fit parameters
* `v`: the fit result parameters
* `f_fit`: the fitted function</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/fit_fwhm.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_fwhm_ft-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T, Bool}} where T&lt;:Real" href="#LegendSpecFits.fit_fwhm_ft-Union{Tuple{T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T}, Tuple{Matrix, StepRangeLen, Vector{&lt;:Real}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, T, Bool}} where T&lt;:Real"><code>LegendSpecFits.fit_fwhm_ft</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_fwhm_ft(e_grid::Matrix, e_grid_ft::StepRangeLen, rt::Unitful.RealOrRealQuantity, min_e::T, max_e::T, rel_cut_fit::T, apply_ctc::Bool=true; kwargs...)
fit_fwhm_ft(e_grid::Matrix, e_grid_ft::StepRangeLen, rt::Unitful.RealOrRealQuantity, min_e, max_e, rel_cut_fit; kwargs...)
fit_fwhm_ft(e_grid::Matrix, e_grid_ft::StepRangeLen, qdrift::Vector{&lt;:Real}, rt::Unitful.RealOrRealQuantity, min_e, max_e, rel_cut_fit; kwargs...)</code></pre><p>Fit the FWHM values in <code>e_grid</code> for each FT in <code>e_grid_ft</code> with a Gamma Peakshape and return the optimal FT and the corresponding FWHM value. The cut values cut for each flat-top time a window for better histogramming. If the <code>apply_ctc</code> flag is set to <code>true</code>, the CTC correction is applied to the energy values.  Othwise, if a <code>qdrift</code> vector is provided, the CTC correction is applied to the energy values.</p><p><strong>Arguments</strong></p><ul><li><code>e_grid</code>: 2D array of energy values for each FT in <code>e_grid_ft</code></li><li><code>e_grid_ft</code>: 1D array of FT values for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>rt</code>: RT value for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>min_e</code>: minimum energy value to consider for the fit</li><li><code>max_e</code>: maximum energy value to consider for the fit</li><li><code>rel_cut_fit</code>: relative cut value to use for the fit</li></ul><p><strong>Returns</strong></p><ul><li><code>ft</code>: optimal FT value</li><li><code>min_fwhm</code>: corresponding FWHM value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/filter_optimization.jl#L75-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_half_centered_trunc_gauss-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, T, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_half_centered_trunc_gauss-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, T, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_centered_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_half_centered_trunc_gauss(x::Array, cuts::NamedTuple{(:low, :high, :max), Tuple{Float64, Float64, Float64}})</code></pre><p>Fit a single truncated Gaussian to the data <code>x</code> between <code>cut.low</code> and <code>cut.high</code>. The peak center is fixed at <code>Œº</code> and the peak is cut in half either in the left or right half.</p><p><strong>Returns <code>report</code> and <code>result</code>` with:</strong></p><pre><code class="nohighlight hljs">* `f_fit`: fitted function
* `Œº`: mean of the Gaussian
* `œÉ`: standard deviation of the Gaussian</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/singlefit.jl#L122-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_half_trunc_gauss-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_half_trunc_gauss-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_half_trunc_gauss(x::Array, cuts::NamedTuple{(:low, :high, :max), Tuple{Float64, Float64, Float64}})</code></pre><p>Fit a single truncated Gaussian to the data <code>x</code> between <code>cut.low</code> and <code>cut.high</code>. The peak center is fixed at <code>Œº</code> and the peak is cut in half either in the left or right half.</p><p><strong>Returns <code>report</code> and <code>result</code> with:</strong></p><pre><code class="nohighlight hljs">* `f_fit`: fitted function
* `Œº`: mean of the Gaussian
* `œÉ`: standard deviation of the Gaussian</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/singlefit.jl#L241-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_lq_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s4235&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4235&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4235&quot;&lt;:Real, U})" href="#LegendSpecFits.fit_lq_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s4235&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4235&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4235&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_lq_compton</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_lq_compton(peakhists::Array, peakstats::StructArray, compton_bands::Array{T}) where T&lt;:Real</code></pre><p>Fit the A/E Compton bands using the <code>f_lq_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: Dict of NamedTuples of the fit results containing values and errors for each compton band
* `report`: Dict of NamedTuples of the fit report which can be plotted for each compton band</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/lqfit.jl#L17-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_peaks-Tuple{Array, StructArrays.StructArray, Vector}" href="#LegendSpecFits.fit_peaks-Tuple{Array, StructArrays.StructArray, Vector}"><code>LegendSpecFits.fit_peaks</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_peaks(peakhists::Array, peakstats::StructArray, th228_lines::Array,; calib_type::Symbol=:th228, uncertainty::Bool=true, low_e_tail::Bool=true)</code></pre><p>Perform a fit of the peakshape to the data in <code>peakhists</code> using the initial values in <code>peakstats</code> to the calibration lines in <code>th228_lines</code>. </p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peak_fit_plots`: array of plots of the peak fits
* `return_vals`: dictionary of the fit results</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_peaks_combined-Tuple{Array, StructArrays.StructArray, Array}" href="#LegendSpecFits.fit_peaks_combined-Tuple{Array, StructArrays.StructArray, Array}"><code>LegendSpecFits.fit_peaks_combined</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_peaks_combined(peakhists::Array, peakstats::StructArray, th228_lines::Array{T},; calib_type::Symbol=:th228, uncertainty::Bool=true, fixed_position::Bool=false) where T&lt;:Real</code></pre><p>Fit the peaks of a histogram to a combined peakshape function while sharring parameters between peaks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit_combined.jl#L59-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_sf_wl-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, ArraysOfArrays.ArrayOfSimilarArrays{var&quot;#s4213&quot;, M, N, L, P} where {var&quot;#s4213&quot;&lt;:Real, M, N, L, P&lt;:AbstractArray{var&quot;#s4213&quot;, L}}, Vector{&lt;:Real}, ArraysOfArrays.ArrayOfSimilarArrays{var&quot;#s4211&quot;, M, N, L, P} where {var&quot;#s4211&quot;&lt;:Real, M, N, L, P&lt;:AbstractArray{var&quot;#s4211&quot;, L}}, StepRangeLen}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s4215&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4215&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4215&quot;&lt;:Real, U})" href="#LegendSpecFits.fit_sf_wl-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, ArraysOfArrays.ArrayOfSimilarArrays{var&quot;#s4213&quot;, M, N, L, P} where {var&quot;#s4213&quot;&lt;:Real, M, N, L, P&lt;:AbstractArray{var&quot;#s4213&quot;, L}}, Vector{&lt;:Real}, ArraysOfArrays.ArrayOfSimilarArrays{var&quot;#s4211&quot;, M, N, L, P} where {var&quot;#s4211&quot;&lt;:Real, M, N, L, P&lt;:AbstractArray{var&quot;#s4211&quot;, L}}, StepRangeLen}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s4215&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4215&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4215&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_sf_wl</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_sf_wl(dep_sep_data, a_grid_wl_sg, optimization_config)</code></pre><p>Fit a A/E filter window length for the SEP data and return the optimal window length and the corresponding survival fraction.</p><p><strong>Arguments</strong></p><ul><li><code>dep_sep_data</code>: NamedTuple with the DEP and SEP data</li><li><code>a_grid_wl_sg</code>: range of window lengths to sweep through</li><li><code>optimization_config</code>: configuration dictionary</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: optimal window length and corresponding survival fraction</li><li><code>report</code>: report with all window lengths and survival fractions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_filter_optimization.jl#L29-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_aoe_compton-Tuple{StatsBase.Histogram, NamedTuple}" href="#LegendSpecFits.fit_single_aoe_compton-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_single_aoe_compton</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_single_aoe_compton(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background, :Œº, :œÉ), NTuple{7, T}}; uncertainty::Bool=true) where T&lt;:Real</code></pre><p>Perform a fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>f_aoe_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoefit.jl#L153-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_aoe_compton_with_fixed_Œº_and_œÉ-Tuple{StatsBase.Histogram, Number, Number, NamedTuple}" href="#LegendSpecFits.fit_single_aoe_compton_with_fixed_Œº_and_œÉ-Tuple{StatsBase.Histogram, Number, Number, NamedTuple}"><code>LegendSpecFits.fit_single_aoe_compton_with_fixed_Œº_and_œÉ</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_single_aoe_compton_with_fixed_Œº_and_œÉ(h::Histogram, Œº::Number, œÉ::Number, ps::NamedTuple; uncertainty::Bool=true)</code></pre><p>Fit a single A/E Compton band using the <code>f_aoe_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events using fixed values for Œº and œÉ.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `neg_log_likelihood`: The negative log-likelihood of the likelihood fit
* `report`: Dict of NamedTuples of the fit report which can be plotted for each compton band</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoefit_combined.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_lq_compton-Tuple{StatsBase.Histogram, NamedTuple}" href="#LegendSpecFits.fit_single_lq_compton-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_single_lq_compton</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_single_lq_compton(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background, :Œº, :œÉ), NTuple{7, T}}; uncertainty::Bool=true) where T&lt;:Real</code></pre><p>Perform a fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>f_lq_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/lqfit.jl#L55-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_peak_th228-Union{Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, bin_width::T, mean_background::T, mean_background_step::T, mean_background_std::T}}} where T&lt;:Real" href="#LegendSpecFits.fit_single_peak_th228-Union{Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, bin_width::T, mean_background::T, mean_background_step::T, mean_background_std::T}}} where T&lt;:Real"><code>LegendSpecFits.fit_single_peak_th228</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_single_peak_th228(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background), NTuple{5, T}};, uncertainty::Bool=true, fixed_position::Bool=false, low_e_tail::Bool=true) where T&lt;:Real</code></pre><p>Perform a fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>gamma_peakshape</code> with low-E tail. Also, FWHM is calculated from the fitted peakshape with MC error propagation. The peak position can be fixed to the value in <code>ps</code> by setting <code>fixed_position=true</code>. If the low-E tail should not be fitted, it can be disabled by setting <code>low_e_tail=false</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit.jl#L70-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_trunc_gauss-Union{Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}}, Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_single_trunc_gauss-Union{Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}}, Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_single_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_single_trunc_gauss(x::Array, cuts::NamedTuple{(:low, :high, :max), Tuple{Float64, Float64, Float64}})</code></pre><p>Fit a single truncated Gaussian to the data <code>x</code> between <code>min_x</code> and <code>max_x</code>. Returns <code>report</code> and <code>result</code><code>with:     *</code>f<em>fit<code>: fitted function     *</code>Œº<code>: mean of the Gaussian     *</code>Œº</em>err<code>: error of the mean     *</code>œÉ<code>: standard deviation of the Gaussian     *</code>œÉ_err<code>: error of the standard deviation     *</code>n`: number of counts in the peak</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/singlefit.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_sipm_spectrum" href="#LegendSpecFits.fit_sipm_spectrum"><code>LegendSpecFits.fit_sipm_spectrum</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_sipm_spectrum(pe_cal::Vector{&lt;:Real}, min_pe::Real=0.5, max_pe::Real=3.5; 
    n_mixtures::Int=ceil(Int, (max_pe - min_pe) * 4), nIter::Int=50, nInit::Int=50, 
    method::Symbol=:kmeans, kind=:diag, Œîpe_peak_assignment::Real=0.3, f_uncal::Function=identity, uncertainty::Bool=true)</code></pre><p>Fit a Gaussian Mixture Model to the given pe calibration data and return the fit parameters.</p><p><strong>Arguments</strong></p><ul><li><code>pe_cal::Vector{&lt;:Real}</code>: the pe calibration data</li><li><code>min_pe::Real=0.5</code>: the minimum pe to consider</li><li><code>max_pe::Real=3.5</code>: the maximum pe to consider</li><li><code>n_mixtures::Int=ceil(Int, (max_pe - min_pe) * 4)</code>: the number of mixtures to fit</li><li><code>nIter::Int=50</code>: the number of iterations for the EM algorithm</li><li><code>nInit::Int=50</code>: the number of initializations for the EM algorithm</li><li><code>method::Symbol=:kmeans</code>: the method to use for initialization</li><li><code>kind::Symbol=:diag</code>: the kind of covariance matrix to use</li><li><code>Œîpe_peak_assignment::Real=0.3</code>: the range to consider for peak assignment</li><li><code>f_uncal::Function=identity</code>: the function to use for uncalibration</li><li><code>uncertainty::Bool=true</code>: whether to calculate the uncertainty</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: a tuple with the fit parameters</li><li><code>report</code>: a tuple with the fit report which can be plotted via a recipe</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/sipmfit.jl#L2-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_subpeaks_th228-Tuple{StatsBase.Histogram, StatsBase.Histogram, NamedTuple}" href="#LegendSpecFits.fit_subpeaks_th228-Tuple{StatsBase.Histogram, StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_subpeaks_th228</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_single_peak_th228(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background), NTuple{5, T}};, uncertainty::Bool=true, fixed_position::Bool=false, low_e_tail::Bool=true) where T&lt;:Real</code></pre><p>Perform a simultaneous fit of two peaks (<code>h_survived</code> and <code>h_cut</code>) that together would form a histogram <code>h</code>, from which the result <code>h_result</code> was already determined using <code>fit_single_peak_th228</code>. Also, FWHM is calculated from the fitted peakshape with MC error propagation. The peak position can be fixed to the value in <code>ps</code> by setting <code>fixed_position=true</code>. If the low-E tail should not be fitted, it can be disabled by setting <code>low_e_tail=false</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors, in particular the signal survival fraction `sf` and the background survival frachtion `bsf`.
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit.jl#L267-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.gamma_peakshape-NTuple{8, Real}" href="#LegendSpecFits.gamma_peakshape-NTuple{8, Real}"><code>LegendSpecFits.gamma_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gamma_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    step_amplitude::Real, skew_fraction::Real, skew_width::Real,
    background::Real;  
    skew_fraction_highE::Real = 0.0, skew_width_highE::Real= 0.0, 
    background_kwargs... 
)</code></pre><p>Standard gamma peakshape: Describes the shape of a typical gamma peak in a detector. Components: </p><ul><li>Gaussian signal peak with <code>Œº</code>, <code>œÉ</code>, <code>n - skew_fraction - skew_fraction_highE</code></li><li>low-energy tail: <code>skew_fraction</code>, <code>skew_width</code></li><li>high-energy tail: <code>skew_fraction_highE</code>, <code>skew_width_highE</code> (optional, default off)</li><li>background:<ul><li>energy-independent <code>background</code></li><li>step-function scaled with <code>step_amplitude</code> from Compton scattered gammas</li><li>linear slope: <code>background_slope</code> (optional, default off)</li><li>exponential decay: <code>background_exp</code> (optional, default off)</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L74-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.gauss_pdf-Tuple{Real, Real, Real}" href="#LegendSpecFits.gauss_pdf-Tuple{Real, Real, Real}"><code>LegendSpecFits.gauss_pdf</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LegendSpecFits.gauss_pdf(x::Real, Œº::Real, œÉ::Real)</code></pre><p>Equivalent to <code>pdf(Normal(Œº, œÉ), x)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.generate_aoe_compton_bands-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, Vector{&lt;:T}, Vector{&lt;:T}, T}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s2692&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s2692&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s2692&quot;&lt;:Real, U})" href="#LegendSpecFits.generate_aoe_compton_bands-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, Vector{&lt;:T}, Vector{&lt;:T}, T}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s2692&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s2692&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s2692&quot;&lt;:Real, U})"><code>LegendSpecFits.generate_aoe_compton_bands</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_aoe_compton_bands(aoe::Vector{&lt;:Real}, e::Vector{&lt;:T}, compton_bands::Vector{&lt;:T}, compton_window::T) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Generate histograms for the A/E Compton bands and estimate peak parameters.  The compton bands are cutted out of the A/E spectrum and then binned using the Freedman-Diaconis Rule. For better performance the binning is only done in the area around the peak. The peak parameters are estimated using the <code>estimate_single_peak_stats_psd</code> function.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peakhists`: Array of histograms for each compton band
* `peakstats`: StructArray of peak parameters for each compton band
* `min_aoe`: Array of minimum A/E values for each compton band
* `max_aoe`: Array of maximum A/E values for each compton band
* `mean_peak_pos`: Mean peak position of all compton bands
* `std_peak_pos`: Standard deviation of the peak position of all compton bands
* `simple_pars_aoe_Œº`: Simple curve fit parameters for the peak position energy depencence
* `simple_pars_error_aoe_Œº`: Simple curve fit parameter errors for the peak position energy depencence
* `simple_pars_aoe_œÉ`: Simple curve fit parameters for the peak sigma energy depencence
* `simple_pars_error_aoe_œÉ`: Simple curve fit parameter errors for the peak sigma energy depencence</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoefit.jl#L3-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_centered_gaussian_window_cut-Union{Tuple{T}, Tuple{Vector{T}, T, T, Real}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.get_centered_gaussian_window_cut-Union{Tuple{T}, Tuple{Vector{T}, T, T, Real}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.get_centered_gaussian_window_cut</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_centered_gaussian_window_cut(x::Array, min_x::Float64, max_x::Float64, n_œÉ::Real, center::Float64=0.0, n_bins_cut::Int=500, relative_cut::Float64=0.2, left::Bool=false)</code></pre><p>Cut out a single peak from the array <code>x</code> between <code>min_x</code> and <code>max_x</code> by fitting a truncated one-sided Gaussian and extrapolating a window cut with <code>n_œÉ</code> standard deviations. The <code>center</code> and side of the fit can be specified with <code>left</code> and <code>center</code> variable.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `low_cut`: lower edge of the cut peak
* `high_cut`: upper edge of the cut peak
* `center`: center of the peak
* `œÉ`: standard deviation of the Gaussian
* `low_cut_fit`: lower edge of the cut peak from the fit
* `high_cut_fit`: upper edge of the cut peak from the fit
* `err`: error of the fit parameters</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/simple_cuts.jl#L59-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_continuum_survival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, T, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s516&quot;&lt;:Real, U})" href="#LegendSpecFits.get_continuum_survival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, T, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s516&quot;&lt;:Real, U})"><code>LegendSpecFits.get_continuum_survival_fraction</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_continuum_survival_fraction(aoe::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T}, center::T, window::T, aoe_cut::Unitful.RealOrRealQuantity,; inverted_mode::Bool=false, sigma_high_sided::Unitful.RealOrRealQuantity=Inf*unit(first(aoe))) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the survival fraction of a continuum after a AoE cut value <code>aoe_cut</code> for a given <code>center</code> and <code>window</code> size.</p><p><strong>Returns</strong></p><ul><li><code>center</code>: Center of the continuum</li><li><code>window</code>: Window size</li><li><code>n_before</code>: Number of counts before the cut</li><li><code>n_after</code>: Number of counts after the cut</li><li><code>sf</code>: Survival fraction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_cut.jl#L191-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_distribution_transform" href="#LegendSpecFits.get_distribution_transform"><code>LegendSpecFits.get_distribution_transform</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_distribution_transform(d::Distribution, pprior::Prior)</code></pre><p>Return a <code>DistributionTransform</code> for the given <code>Distribution</code> and <code>Prior</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_friedman_diaconis_bin_width" href="#LegendSpecFits.get_friedman_diaconis_bin_width"><code>LegendSpecFits.get_friedman_diaconis_bin_width</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_friedman_diaconis_bin_width(x::AbstractArray)</code></pre><p>Return the bin width for the given data <code>x</code> using the Friedman-Diaconis rule.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_low_aoe_cut-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s385&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s385&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s385&quot;&lt;:Real, U})" href="#LegendSpecFits.get_low_aoe_cut-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s385&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s385&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s385&quot;&lt;:Real, U})"><code>LegendSpecFits.get_low_aoe_cut</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_low_aoe_cut(aoe::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T},; 
        dep::T=1592.53u&quot;keV&quot;, window::Vector{&lt;:T}=[12.0, 10.0]u&quot;keV&quot;, dep_sf::Float64=0.9, rtol::Float64=0.001, maxiters::Int=300, sigma_high_sided::Float64=Inf,
        cut_search_interval::Tuple{&lt;:Unitful.RealOrRealQuantity, &lt;:Unitful.RealOrRealQuantity}=(-25.0*unit(first(aoe)), 1.0*unit(first(aoe))), 
        bin_width_window::T=3.0u&quot;keV&quot;, max_e_plot::T=3000.0u&quot;keV&quot;,  plot_window::Vector{&lt;:T}=[12.0, 50.0]u&quot;keV&quot;,
        fixed_position::Bool=true, fit_func::Symbol=:gamma_def, uncertainty::Bool=true) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the AoE cut value for a given <code>dep</code> and <code>window</code> size while performing a peak fit with fixed position. The AoE cut value is determined by finding the cut value for which the number of counts after the cut is equal to <code>dep_sf</code> times the number of counts before the cut. The algorhithm utilizes a root search algorithm to find the cut value with a relative tolerance of <code>rtol</code>.</p><p><strong>Returns</strong></p><ul><li><code>cut</code>: AoE cut value</li><li><code>n0</code>: Number of counts before the cut</li><li><code>nsf</code>: Number of counts after the cut</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_cut.jl#L22-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, NamedTuple, Integer}" href="#LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, NamedTuple, Integer}"><code>LegendSpecFits.get_mc_value_shapes</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mc_value_shapes(v::NamedTuple, v_err::NamedTuple, n::Integer)</code></pre><p>Return a <code>NamedTuple</code> with the same fields as <code>v</code> and <code>v_err</code> but with <code>Normal</code> distributions for each field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L69-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_mc_value_shapes-Union{Tuple{T}, Tuple{V}, Tuple{V, Matrix{T}, Integer}} where {V&lt;:NamedTuple, T&lt;:AbstractFloat}" href="#LegendSpecFits.get_mc_value_shapes-Union{Tuple{T}, Tuple{V}, Tuple{V, Matrix{T}, Integer}} where {V&lt;:NamedTuple, T&lt;:AbstractFloat}"><code>LegendSpecFits.get_mc_value_shapes</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mc_value_shapes(v::NamedTuple, v_err::Matrix, n::Integer)</code></pre><p>Generate <code>n</code> random samples of fit parameters using their respective best-fit values <code>v</code> and covariance matrix <code>v_err</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L79-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_number_of_bins-Tuple{AbstractArray}" href="#LegendSpecFits.get_number_of_bins-Tuple{AbstractArray}"><code>LegendSpecFits.get_number_of_bins</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_number_of_bins(x::AbstractArray,; method::Symbol=:sqrt)</code></pre><p>Return the number of bins for the given data <code>x</code> using the given method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L115-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peak_fwhm_th228" href="#LegendSpecFits.get_peak_fwhm_th228"><code>LegendSpecFits.get_peak_fwhm_th228</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_peak_fwhm_th228(v_ml::NamedTuple, v_ml_err::NamedTuple)</code></pre><p>Get the FWHM of a peak from the fit parameters while performing a MC error propagation.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `fwhm`: the FWHM of the peak
* `fwhm_err`: the uncertainty of the FWHM of the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit.jl#L238-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peak_survival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s414&quot;&lt;:Real, U})" href="#LegendSpecFits.get_peak_survival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s414&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s414&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peak_survival_fraction</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_peak_survival_fraction(aoe::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T}, peak::T, window::Vector{T}, aoe_cut::Unitful.RealOrRealQuantity,; 
uncertainty::Bool=true, inverted_mode::Bool=false, bin_width_window::T=2.0u&quot;keV&quot;, sigma_high_sided::Unitful.RealOrRealQuantity=Inf*unit(first(aoe)), fit_func::Symbol=:gamma_def) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the survival fraction of a peak after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size while performing a peak fit with fixed position.</p><p><strong>Returns</strong></p><ul><li><code>peak</code>: Peak position</li><li><code>n_before</code>: Number of counts before the cut</li><li><code>n_after</code>: Number of counts after the cut</li><li><code>sf</code>: Survival fraction</li><li><code>err</code>: Uncertainties</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_cut.jl#L126-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peakhists_th228-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s240&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s240&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s240&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s199&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s199&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s199&quot;&lt;:Real, U}}, Vector{&lt;:Tuple{Union{Unitful.Quantity{var&quot;#s197&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s197&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s197&quot;&lt;:Real, U}, Union{Unitful.Quantity{var&quot;#s27&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s27&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s27&quot;&lt;:Real, U}}}}" href="#LegendSpecFits.get_peakhists_th228-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s240&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s240&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s240&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s199&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s199&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s199&quot;&lt;:Real, U}}, Vector{&lt;:Tuple{Union{Unitful.Quantity{var&quot;#s197&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s197&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s197&quot;&lt;:Real, U}, Union{Unitful.Quantity{var&quot;#s27&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s27&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s27&quot;&lt;:Real, U}}}}"><code>LegendSpecFits.get_peakhists_th228</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_peakhists_th228(e::Array, th228_lines::Array, window_sizes::Array, e_unit::String=&quot;keV&quot;, proxy_binning_peak::Float64=2103.5, proxy_binning_peak_window::Float64=10.0)</code></pre><p>Create histograms around the calibration lines and return the histograms and the peak statistics.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peakhists`: array of histograms around the calibration lines
* `peakstats`: array of statistics for the calibration line fits</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/simple_calibration.jl#L85-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peaks_survival_fractions-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, Vector{&lt;:T}, Vector{Symbol}, Vector{&lt;:Tuple{T, T}}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s386&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s386&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s386&quot;&lt;:Real, U})" href="#LegendSpecFits.get_peaks_survival_fractions-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, Vector{&lt;:T}, Vector{Symbol}, Vector{&lt;:Tuple{T, T}}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s386&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s386&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s386&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peaks_survival_fractions</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_peaks_survival_fractions(aoe::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T}, peaks::Vector{&lt;:T}, peak_names::Vector{Symbol}, windows::Vector{&lt;:Tuple{T, T}}, aoe_cut::Unitful.RealOrRealQuantity,; uncertainty::Bool=true, inverted_mode::Bool=false, bin_width_window::T=2.0u&quot;keV&quot;, sigma_high_sided::Unitful.RealOrRealQuantity=Inf*unit(first(aoe)), fit_funcs::Vector{Symbol}=fill(:gamma_def, length(peaks))) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the survival fraction of a peak after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size while performing a peak fit with fixed position.</p><p><strong>Return</strong></p><ul><li><code>result</code>: Dict of results for each peak</li><li><code>report</code>: Dict of reports for each peak</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_cut.jl#L90-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_residuals-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}" href="#LegendSpecFits.get_residuals-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}"><code>LegendSpecFits.get_residuals</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">residuals(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},v_ml::Union{NamedTuple, AbstractVector})</code></pre><p>Calculate bin-wise residuals and normalized residuals.  Calcualte bin-wise p-value based on poisson distribution for each bin.</p><p><strong>Input:</strong></p><ul><li><code>f_fit</code>function handle of fit function (peakshape)</li><li><code>h</code> histogram of data</li><li><code>v_ml</code> best-fit parameters</li></ul><p><strong>Returns:</strong></p><ul><li><code>residuals</code> difference: model - data (histogram bin count)</li><li><code>residuals_norm</code> normalized residuals: model - data / sqrt(model)</li><li><code>p_value_binwise</code> p-value for each bin based on poisson distribution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/gof.jl#L157-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_sf_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s516&quot;&lt;:Real, U})" href="#LegendSpecFits.get_sf_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s516&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s516&quot;&lt;:Real, U})"><code>LegendSpecFits.get_sf_after_aoe_cut</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sf_after_aoe_cut(aoe_cut::Unitful.RealOrRealQuantity, aoe::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T}, peak::T, window::Vector{T}, bin_width::T, result_before::NamedTuple; uncertainty::Bool=true, fit_func::Symbol=:gamma_def) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the survival fraction after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size from a combined fit to the survived and cut histograms.</p><p><strong>Returns</strong></p><ul><li><code>sf</code>: Survival fraction after the cut</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_cut.jl#L2-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_th228_fit_functions-Tuple{}" href="#LegendSpecFits.get_th228_fit_functions-Tuple{}"><code>LegendSpecFits.get_th228_fit_functions</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_th228_fit_functions(; background_center::Union{Real,Nothing} = nothing)</code></pre><p>This function defines the gamma peakshape fit functions used in the calibration specfits.</p><ul><li>gamma_def: &quot;default&quot; gamma peakshape with gaussian signal, low-energy tail, and background (flat + step)</li><li>gamma_tails: default gamma peakshape + high-energy tail</li><li>gamma_bckSlope: default gamma peakshape + linear background slope</li><li>gamma_bckExp: default gamma peakshape + exponential background </li><li>gamma_bckFlat: default gamma peakshape - step background (only flat component!)</li><li>gamma<em>tails</em>bckFlat: default gamma peakshape + high-energy tail - step background (only flat component!)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit_functions.jl#L2-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.highEtail_peakshape-NTuple{6, Real}" href="#LegendSpecFits.highEtail_peakshape-NTuple{6, Real}"><code>LegendSpecFits.highEtail_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">highEtail_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    skew_fraction::Real, skew_width::Real,
)</code></pre><p>Describes the high-E signal tail part of the shape </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L160-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.hist_loglike-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}}" href="#LegendSpecFits.hist_loglike-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits.hist_loglike</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hist_loglike(f_fit::Base.Callable, h::Histogram{&lt;:Real,1})</code></pre><p>Calculate the Poisson log-likelihood of a fit function <code>f_fit(x)</code> and a histogram <code>h</code>. <code>f_fit</code> must accept all values <code>x</code> on the horizontal axis of the histogram.</p><p>Currently uses a simple midpoint-rule integration of <code>f_fit</code> over the bins of <code>h</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/likelihoods.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.linear_function-Tuple{Real, Real, Real}" href="#LegendSpecFits.linear_function-Tuple{Real, Real, Real}"><code>LegendSpecFits.linear_function</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_function(x::Real, slope::Real, intercept::Real)</code></pre><p>Evaluates a linear function at <code>x</code> with parameters <code>slope</code> and <code>intercept</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.lowEtail_peakshape-NTuple{6, Real}" href="#LegendSpecFits.lowEtail_peakshape-NTuple{6, Real}"><code>LegendSpecFits.lowEtail_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lowEtail_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    skew_fraction::Real, skew_width::Real,
)</code></pre><p>Describes the low-E signal tail part of the shape of a typical gamma peak in a detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L143-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.lq_drift_time_correction-Tuple{Vector{&lt;:AbstractFloat}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s4225&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4225&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4225&quot;&lt;:Real, U}}, Unitful.AbstractQuantity, Unitful.AbstractQuantity}" href="#LegendSpecFits.lq_drift_time_correction-Tuple{Vector{&lt;:AbstractFloat}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s4225&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s4225&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s4225&quot;&lt;:Real, U}}, Unitful.AbstractQuantity, Unitful.AbstractQuantity}"><code>LegendSpecFits.lq_drift_time_correction</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lq_norm::Vector{Float64}, dt_eff::Vector{&lt;:Unitful.RealOrRealQuantity}, e_cal::Vector{&lt;:Unitful.Energy{&lt;:Real}}, DEP_¬µ::Unitful.AbstractQuantity, DEP_œÉ::Unitful.AbstractQuantity; 
DEP_edgesigma::Float64=3.0 , mode::Symbol=:percentile, drift_cutoff_sigma::Float64 = 2.0, prehist_sigma::Float64=2.5, e_expression::Union{String,Symbol}=&quot;e&quot;, dt_eff_low_quantile::Float64=0.15, dt_eff_high_quantile::Float64=0.95)</code></pre><p>Perform the drift time correction on the LQ data using the DEP peak. The function cuts outliers in lq and drift time, then performs a linear fit on the remaining data. The data is Corrected by subtracting the linear fit from the lq data.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the function used for lq classifier construction
* `report`: NamedTuple of the histograms used for the fit, the cutoff values and the DEP edges</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/lqcut.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.nearestSPD-Tuple{Matrix{&lt;:Real}}" href="#LegendSpecFits.nearestSPD-Tuple{Matrix{&lt;:Real}}"><code>LegendSpecFits.nearestSPD</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearestSPD(A::Matrix{&lt;:Real})</code></pre><p>Returns the nearest positive definite matrix to A Calculation is based on matrix factorization techniques described in https://www.sciencedirect.com/science/article/pii/0024379588902236</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L139-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.p_value-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}" href="#LegendSpecFits.p_value-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}"><code>LegendSpecFits.p_value</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">p_value(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},v_ml::Union{NamedTuple, AbstractVector})</code></pre><p>calculate p-value based on least-squares, assuming gaussian uncertainty baseline method to get goodness-of-fit (gof)</p><p><strong>input:</strong></p><ul><li><code>f_fit</code>function handle of fit function (peakshape)</li><li><code>h</code> histogram of data</li><li><code>v_ml</code> best-fit parameters</li></ul><p><strong>returns:</strong></p><ul><li><code>pval</code> p-value of chi2 test</li><li><code>chi2</code> chi2 value</li><li><code>dof</code> degrees of freedom</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/gof.jl#L30-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.p_value_MC-Union{Tuple{T}, Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, mean_background::T, mean_background_step::T, mean_background_std::T}, NamedTuple}} where T&lt;:Real" href="#LegendSpecFits.p_value_MC-Union{Tuple{T}, Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, mean_background::T, mean_background_step::T, mean_background_std::T}, NamedTuple}} where T&lt;:Real"><code>LegendSpecFits.p_value_MC</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">p_value_MC(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background)},v_ml::NamedTuple,;n_samples::Int64=1000)</code></pre><p>alternative p-value calculation via Monte Carlo sampling. <strong>Warning</strong>: computational more expensive than p<em>vaule() and p</em>value_LogLikeRatio()</p><p><strong>Input:</strong></p><ul><li><code>f_fit</code>function handle of fit function (peakshape)</li><li><code>h</code> histogram of data</li><li><code>ps</code> best-fit parameters</li><li><code>v_ml</code> best-fit parameters</li><li><code>n_samples</code> number of samples</li></ul><p><strong>Performed Steps:</strong></p><ul><li>Create n_samples randomized histograms. For each bin, samples are drawn from a Poisson distribution with Œª = model peak shape (best-fit parameter)</li><li>Each sample histogram is fit using the model function <code>f_fit</code></li><li>For each sample fit, the max. loglikelihood fit is calculated </li></ul><p><strong>Returns</strong></p><ul><li>% p value ‚Äì&gt; comparison of sample max. loglikelihood and max. loglikelihood of best-fit</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/gof.jl#L107-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.p_value_poissonll-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}" href="#LegendSpecFits.p_value_poissonll-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, Union{NamedTuple, AbstractVector}}"><code>LegendSpecFits.p_value_poissonll</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">p_value_poissonll(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},v_ml::Union{NamedTuple, AbstractVector})</code></pre><p>p-value via poisson likelihood ratio: baseline for ML fits using Poisson statistics and bins with low number of counts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/gof.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.peak_centroid-Tuple{NamedTuple}" href="#LegendSpecFits.peak_centroid-Tuple{NamedTuple}"><code>LegendSpecFits.peak_centroid</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">peak_centroid(v::NamedTuple)</code></pre><p>calculate centroid of gamma peak from fit parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit.jl#L192-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.peakshape_components-Tuple{Symbol}" href="#LegendSpecFits.peakshape_components-Tuple{Symbol}"><code>LegendSpecFits.peakshape_components</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">peakshape_components(fit_func::Symbol; background_center::Real)</code></pre><p>This function defines the components (signal, low/high-energy tail, backgrounds) of the fit function used in gamma specfits.  These component functions are used in the fit-report and in plot receipes </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/specfit_functions.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.prepare_sep_peakhist-Union{Tuple{Vector{&lt;:T}}, Tuple{T}} where T&lt;:Real" href="#LegendSpecFits.prepare_sep_peakhist-Union{Tuple{Vector{&lt;:T}}, Tuple{T}} where T&lt;:Real"><code>LegendSpecFits.prepare_sep_peakhist</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_sep_peakhist(e::Array{T}, dep::T,; relative_cut::T=0.5, n_bins_cut::Int=500) where T&lt;:Real</code></pre><p>Prepare an array of uncalibrated SEP energies for parameter extraction and calibration.</p><p><strong>Returns</strong></p><ul><li><code>result</code>: Result of the initial fit</li><li><code>report</code>: Report of the initial fit</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/aoe_filter_optimization.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.pulser_cal_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table" href="#LegendSpecFits.pulser_cal_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.pulser_cal_qc</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pulser_cal_qc(data, pulser_config; n_pulser_identified=100)</code></pre><p>Perform simple QC cuts on the data and return the data for energy calibration.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">- pulser_idx: indices of the pulser events</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/qc.jl#L81-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.set_memlimit-Tuple{Float64}" href="#LegendSpecFits.set_memlimit-Tuple{Float64}"><code>LegendSpecFits.set_memlimit</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_memlimit(gig::Float64)
Set memory limit in GB for the whole current process ignoring if things could run in parallel</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/memory_utils.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.set_timelimit-Tuple{Float64}" href="#LegendSpecFits.set_timelimit-Tuple{Float64}"><code>LegendSpecFits.set_timelimit</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_timelimit(sec::Float64)
Set time limit in seconds a single Optim.jl optimization step</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/memory_utils.jl#L14-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.signal_peakshape-NTuple{5, Real}" href="#LegendSpecFits.signal_peakshape-NTuple{5, Real}"><code>LegendSpecFits.signal_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">signal_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    skew_fraction::Real;  skew_fraction_highE::Real = 0.0
)</code></pre><p>Describes the signal part of the shape of a typical gamma peak in a detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L108-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.simple_calibration" href="#LegendSpecFits.simple_calibration"><code>LegendSpecFits.simple_calibration</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simple_calibration(e_uncal::Array, th228_lines::Array, window_size::Float64=25.0, n_bins::Int=15000, calib_type::String=&quot;th228&quot;)</code></pre><p>Perform a simple calibration for the uncalibrated energy array <code>e_uncal</code>  using the calibration type <code>calib_type</code> and the calibration lines <code>th228_lines</code>.  The window size is the size of the window around the calibration line to use for the calibration.  The number of bins is the number of bins to use for the histogram.</p><p>Returns      * <code>h_calsimple</code>: histogram of the calibrated energy array     * <code>h_uncal</code>: histogram of the uncalibrated energy array     * <code>c</code>: calibration factor     * <code>fep_guess</code>: estimated full energy peak (FEP)     * <code>peakhists</code>: array of histograms around the calibration lines     * <code>peakstats</code>: array of statistics for the calibration line fits</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/simple_calibration.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.sipm_simple_calibration" href="#LegendSpecFits.sipm_simple_calibration"><code>LegendSpecFits.sipm_simple_calibration</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sipm_simple_calibration(pe_uncal::Array)</code></pre><p>Perform a simple calibration for the uncalibrated p.e. spectrum array <code>pe_uncal</code> using just the 1 p.e. and 2 p.e. peak positions estimated by a peakfinder.</p><p>Inputs:     * <code>pe_uncal</code>: array of uncalibrated peak amplitudes kwargs:     * <code>initial_min_amp</code>: uncalibrated amplitude value as a left boundary to build the uncalibrated histogram where the peak search is performed on.                         For the peak search with noise peak, this value is consecutively increased i.o.t exclude the noise peak from the histogram.     * <code>initial_max_quantile</code>: quantile of the uncalibrated amplitude array to used as right boundary to build the uncalibrated histogram     * <code>peakfinder_œÉ</code>: sigma value in number of bins for peakfinder     * <code>peakfinder_threshold</code>: threshold value for peakfinder</p><p>Returns      * <code>pe_simple_cal</code>: array of the calibrated pe array with the simple calibration     * <code>func</code>: function to use for the calibration (<code>pe_simple_cal = pe_uncal .* c .+ offset</code>)     * <code>c</code>: calibration factor     * <code>offset</code>: calibration offset      * <code>peakpos</code>: 1 p.e. and 2 p.e. peak positions in uncalibrated amplitude     * <code>peakpos_cal</code>: 1 p.e. and 2 p.e. peak positions in calibrated amplitude     * <code>h_uncal</code>: histogram of the uncalibrated pe array     * <code>h_calsimple</code>: histogram of the calibrated pe array with the simple calibration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/sipm_simple_calibration.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.step_gauss-Tuple{Real, Real, Real}" href="#LegendSpecFits.step_gauss-Tuple{Real, Real, Real}"><code>LegendSpecFits.step_gauss</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">step_gauss(x::Real, Œº::Real, œÉ::Real)</code></pre><p>Evaluates the convulution of a Heaviside step function and the PDF of <code>Normal(Œº, œÉ)</code> at <code>x</code>.</p><p>The result does not correspond to a PDF as it is not normalizable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/peakshapes.jl#L40-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.subhist-Tuple{StatsBase.Histogram{&lt;:Any, 1}, Tuple{Real, Real}}" href="#LegendSpecFits.subhist-Tuple{StatsBase.Histogram{&lt;:Any, 1}, Tuple{Real, Real}}"><code>LegendSpecFits.subhist</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subhist(h::Histogram, r::Tuple{&lt;:Real,&lt;:Real})</code></pre><p>Return a new <code>Histogram</code> with the bins in the range <code>r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.tuple_to_array-Tuple{NamedTuple}" href="#LegendSpecFits.tuple_to_array-Tuple{NamedTuple}"><code>LegendSpecFits.tuple_to_array</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tuple_to_array(nt::NamedTuple, fields::Vector{Symbol})</code></pre><p>Return an array with the values of the fields in <code>nt</code> in the order given by <code>fields</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/utils.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.weibull_from_mx" href="#LegendSpecFits.weibull_from_mx"><code>LegendSpecFits.weibull_from_mx</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">weibull_from_mx(m::Real, x::Real, p_x::Real = 0.6827)::Weibull</code></pre><p>Construct a Weibull distribution with a given median <code>m</code> and a given <code>p_x</code>-quantile <code>x</code>.</p><p>Useful to construct priors for positive quantities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/663ab46198e0bde43de375e52b5e632cd87040b2/src/priors.jl#L4-L11">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">¬´ Home</a><a class="docs-footer-nextpage" href="../LICENSE/">LICENSE ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 12 December 2024 00:12">Thursday 12 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
