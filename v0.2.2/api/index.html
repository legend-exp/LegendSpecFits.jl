<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API ¬∑ LegendSpecFits</title><meta name="title" content="API ¬∑ LegendSpecFits"/><meta property="og:title" content="API ¬∑ LegendSpecFits"/><meta property="twitter:title" content="API ¬∑ LegendSpecFits"/><meta name="description" content="Documentation for LegendSpecFits."/><meta property="og:description" content="Documentation for LegendSpecFits."/><meta property="twitter:description" content="Documentation for LegendSpecFits."/><meta property="og:url" content="https://legend-exp.github.io/LegendSpecFits.jl/stable/api/"/><meta property="twitter:url" content="https://legend-exp.github.io/LegendSpecFits.jl/stable/api/"/><link rel="canonical" href="https://legend-exp.github.io/LegendSpecFits.jl/stable/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LegendSpecFits</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Modules"><span>Modules</span></a></li><li><a class="tocitem" href="#Types-and-constants"><span>Types and constants</span></a></li><li><a class="tocitem" href="#Functions-and-macros"><span>Functions and macros</span></a></li><li class="toplevel"><a class="tocitem" href="#Documentation"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/legend-exp/LegendSpecFits.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Modules"><a class="docs-heading-anchor" href="#Modules">Modules</a><a id="Modules-1"></a><a class="docs-heading-anchor-permalink" href="#Modules" title="Permalink"></a></h2><ul><li><a href="#LegendSpecFits.LegendSpecFits"><code>LegendSpecFits.LegendSpecFits</code></a></li></ul><h2 id="Types-and-constants"><a class="docs-heading-anchor" href="#Types-and-constants">Types and constants</a><a id="Types-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Types-and-constants" title="Permalink"></a></h2><ul></ul><h2 id="Functions-and-macros"><a class="docs-heading-anchor" href="#Functions-and-macros">Functions and macros</a><a id="Functions-and-macros-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-macros" title="Permalink"></a></h2><ul><li><a href="#LegendSpecFits._get_model_counts-Tuple{Union{Function, Type}, NamedTuple, StepRangeLen, StepRangeLen}"><code>LegendSpecFits._get_model_counts</code></a></li><li><a href="#LegendSpecFits._prepare_data-Tuple{StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits._prepare_data</code></a></li><li><a href="#LegendSpecFits.aoe_compton_background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.aoe_compton_background_peakshape</code></a></li><li><a href="#LegendSpecFits.aoe_compton_peakshape-NTuple{6, Real}"><code>LegendSpecFits.aoe_compton_peakshape</code></a></li><li><a href="#LegendSpecFits.aoe_compton_signal_peakshape-NTuple{4, Real}"><code>LegendSpecFits.aoe_compton_signal_peakshape</code></a></li><li><a href="#LegendSpecFits.array_to_tuple-Tuple{AbstractArray, NamedTuple}"><code>LegendSpecFits.array_to_tuple</code></a></li><li><a href="#LegendSpecFits.autocal_energy-Tuple{AbstractArray{&lt;:Real}}"><code>LegendSpecFits.autocal_energy</code></a></li><li><a href="#LegendSpecFits.background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.background_peakshape</code></a></li><li><a href="#LegendSpecFits.baseline_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.baseline_qc</code></a></li><li><a href="#LegendSpecFits.chi2fit-Tuple{Function, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>LegendSpecFits.chi2fit</code></a></li><li><a href="#LegendSpecFits.ctc_energy"><code>LegendSpecFits.ctc_energy</code></a></li><li><a href="#LegendSpecFits.cut_single_peak-Union{Tuple{T}, Tuple{Vector{T}, T, T}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.cut_single_peak</code></a></li><li><a href="#LegendSpecFits.estimate_combined_peak_stats-Tuple{StructArrays.StructArray}"><code>LegendSpecFits.estimate_combined_peak_stats</code></a></li><li><a href="#LegendSpecFits.estimate_fwhm-Tuple{NamedTuple}"><code>LegendSpecFits.estimate_fwhm</code></a></li><li><a href="#LegendSpecFits.estimate_single_peak_stats-Tuple{StatsBase.Histogram}"><code>LegendSpecFits.estimate_single_peak_stats</code></a></li><li><a href="#LegendSpecFits.estimate_single_peak_stats_psd-Union{Tuple{StatsBase.Histogram{T}}, Tuple{T}} where T&lt;:Real"><code>LegendSpecFits.estimate_single_peak_stats_psd</code></a></li><li><a href="#LegendSpecFits.ex_gauss_pdf-NTuple{4, Real}"><code>LegendSpecFits.ex_gauss_pdf</code></a></li><li><a href="#LegendSpecFits.ex_step_gauss-NTuple{5, Real}"><code>LegendSpecFits.ex_step_gauss</code></a></li><li><a href="#LegendSpecFits.expand_vars-Tuple{NamedTuple}"><code>LegendSpecFits.expand_vars</code></a></li><li><a href="#LegendSpecFits.exponential_decay-NTuple{4, Real}"><code>LegendSpecFits.exponential_decay</code></a></li><li><a href="#LegendSpecFits.f_optimize_ctc-NTuple{4, Any}"><code>LegendSpecFits.f_optimize_ctc</code></a></li><li><a href="#LegendSpecFits.fit_aoe_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s3&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_aoe_compton</code></a></li><li><a href="#LegendSpecFits.fit_aoe_corrections-Tuple{Array{&lt;:Union{Unitful.Quantity{var&quot;#s526&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s526&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s526&quot;&lt;:Real, U}}, Array{&lt;:Real}, Array{&lt;:Real}}"><code>LegendSpecFits.fit_aoe_corrections</code></a></li><li><a href="#LegendSpecFits.fit_calibration-Tuple{Int64, AbstractVector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, AbstractVector{&lt;:Unitful.Quantity}}"><code>LegendSpecFits.fit_calibration</code></a></li><li><a href="#LegendSpecFits.fit_enc_sigmas-Union{Tuple{T}, Tuple{Matrix{T}, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, T, T, Int64, T}} where T&lt;:Real"><code>LegendSpecFits.fit_enc_sigmas</code></a></li><li><a href="#LegendSpecFits.fit_fwhm-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s5&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s5&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s5&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s3&quot;&lt;:Real, U}}}"><code>LegendSpecFits.fit_fwhm</code></a></li><li><a href="#LegendSpecFits.fit_fwhm_ft_fep-Union{Tuple{T}, Tuple{Matrix, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, Int64, T}} where T&lt;:Real"><code>LegendSpecFits.fit_fwhm_ft_fep</code></a></li><li><a href="#LegendSpecFits.fit_half_centered_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, T, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_centered_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_half_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_peaks-Tuple{Array, StructArrays.StructArray, Vector}"><code>LegendSpecFits.fit_peaks</code></a></li><li><a href="#LegendSpecFits.fit_peaks_combined-Tuple{Array, StructArrays.StructArray, Array}"><code>LegendSpecFits.fit_peaks_combined</code></a></li><li><a href="#LegendSpecFits.fit_sg_wl-Tuple{NamedTuple{(:dep, :sep)}, StepRangeLen, PropDicts.PropDict}"><code>LegendSpecFits.fit_sg_wl</code></a></li><li><a href="#LegendSpecFits.fit_single_aoe_compton-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_single_aoe_compton</code></a></li><li><a href="#LegendSpecFits.fit_single_peak_th228-Union{Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, mean_background::T, mean_background_step::T, mean_background_std::T}}} where T&lt;:Real"><code>LegendSpecFits.fit_single_peak_th228</code></a></li><li><a href="#LegendSpecFits.fit_single_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_single_trunc_gauss</code></a></li><li><a href="#LegendSpecFits.fit_subpeaks_th228-Tuple{StatsBase.Histogram, StatsBase.Histogram, Any}"><code>LegendSpecFits.fit_subpeaks_th228</code></a></li><li><a href="#LegendSpecFits.gamma_peakshape-NTuple{8, Real}"><code>LegendSpecFits.gamma_peakshape</code></a></li><li><a href="#LegendSpecFits.gauss_pdf-Tuple{Real, Real, Real}"><code>LegendSpecFits.gauss_pdf</code></a></li><li><a href="#LegendSpecFits.generate_aoe_compton_bands-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, Vector{&lt;:T}, Vector{&lt;:T}, T}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s124&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s124&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s124&quot;&lt;:Real, U})"><code>LegendSpecFits.generate_aoe_compton_bands</code></a></li><li><a href="#LegendSpecFits.get_aoe_cut-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s145&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s145&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s145&quot;&lt;:Real, U})"><code>LegendSpecFits.get_aoe_cut</code></a></li><li><a href="#LegendSpecFits.get_centered_gaussian_window_cut-Union{Tuple{T}, Tuple{Vector{T}, T, T, Real}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.get_centered_gaussian_window_cut</code></a></li><li><a href="#LegendSpecFits.get_continuum_surrival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, T, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1251&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1251&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1251&quot;&lt;:Real, U})"><code>LegendSpecFits.get_continuum_surrival_fraction</code></a></li><li><a href="#LegendSpecFits.get_distribution_transform"><code>LegendSpecFits.get_distribution_transform</code></a></li><li><a href="#LegendSpecFits.get_friedman_diaconis_bin_width"><code>LegendSpecFits.get_friedman_diaconis_bin_width</code></a></li><li><a href="#LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, Matrix, Integer}"><code>LegendSpecFits.get_mc_value_shapes</code></a></li><li><a href="#LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, NamedTuple, Integer}"><code>LegendSpecFits.get_mc_value_shapes</code></a></li><li><a href="#LegendSpecFits.get_n_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1250&quot;&lt;:Real, U})"><code>LegendSpecFits.get_n_after_aoe_cut</code></a></li><li><a href="#LegendSpecFits.get_number_of_bins-Tuple{AbstractArray}"><code>LegendSpecFits.get_number_of_bins</code></a></li><li><a href="#LegendSpecFits.get_peak_fwhm_th228"><code>LegendSpecFits.get_peak_fwhm_th228</code></a></li><li><a href="#LegendSpecFits.get_peak_surrival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1249&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1249&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1249&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peak_surrival_fraction</code></a></li><li><a href="#LegendSpecFits.get_peakhists_th228-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s1257&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1257&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1257&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s1259&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1259&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1259&quot;&lt;:Real, U}}, Vector{&lt;:Tuple{Union{Unitful.Quantity{var&quot;#s1261&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1261&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1261&quot;&lt;:Real, U}, Union{Unitful.Quantity{var&quot;#s1262&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1262&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1262&quot;&lt;:Real, U}}}}"><code>LegendSpecFits.get_peakhists_th228</code></a></li><li><a href="#LegendSpecFits.get_peaks_surrival_fractions-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, Vector{&lt;:T}, Vector{Symbol}, Vector{&lt;:Tuple{T, T}}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s523&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s523&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s523&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peaks_surrival_fractions</code></a></li><li><a href="#LegendSpecFits.get_residuals-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}"><code>LegendSpecFits.get_residuals</code></a></li><li><a href="#LegendSpecFits.get_sf_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1250&quot;&lt;:Real, U})"><code>LegendSpecFits.get_sf_after_aoe_cut</code></a></li><li><a href="#LegendSpecFits.hist_loglike-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits.hist_loglike</code></a></li><li><a href="#LegendSpecFits.linear_function-Tuple{Real, Real, Real}"><code>LegendSpecFits.linear_function</code></a></li><li><a href="#LegendSpecFits.lowEtail_peakshape-NTuple{6, Real}"><code>LegendSpecFits.lowEtail_peakshape</code></a></li><li><a href="#LegendSpecFits.nearestSPD-Tuple{Matrix{&lt;:Real}}"><code>LegendSpecFits.nearestSPD</code></a></li><li><a href="#LegendSpecFits.p_value-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}"><code>LegendSpecFits.p_value</code></a></li><li><a href="#LegendSpecFits.p_value_LogLikeRatio-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}"><code>LegendSpecFits.p_value_LogLikeRatio</code></a></li><li><a href="#LegendSpecFits.p_value_MC-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background)}, NamedTuple}"><code>LegendSpecFits.p_value_MC</code></a></li><li><a href="#LegendSpecFits.prepare_dep_peakhist-Union{Tuple{T}, Tuple{Array{T}, Unitful.Quantity{T}}} where T&lt;:Real"><code>LegendSpecFits.prepare_dep_peakhist</code></a></li><li><a href="#LegendSpecFits.pulser_cal_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.pulser_cal_qc</code></a></li><li><a href="#LegendSpecFits.signal_peakshape-NTuple{5, Real}"><code>LegendSpecFits.signal_peakshape</code></a></li><li><a href="#LegendSpecFits.simple_calibration"><code>LegendSpecFits.simple_calibration</code></a></li><li><a href="#LegendSpecFits.step_gauss-Tuple{Real, Real, Real}"><code>LegendSpecFits.step_gauss</code></a></li><li><a href="#LegendSpecFits.subhist-Tuple{StatsBase.Histogram{&lt;:Any, 1}, Tuple{Real, Real}}"><code>LegendSpecFits.subhist</code></a></li><li><a href="#LegendSpecFits.tuple_to_array-Tuple{NamedTuple}"><code>LegendSpecFits.tuple_to_array</code></a></li><li><a href="#LegendSpecFits.weibull_from_mx"><code>LegendSpecFits.weibull_from_mx</code></a></li></ul><h1 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.LegendSpecFits" href="#LegendSpecFits.LegendSpecFits"><code>LegendSpecFits.LegendSpecFits</code></a> ‚Äî <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">LegendSpecFits</code></pre><p>Template for Julia packages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/LegendSpecFits.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits._get_model_counts-Tuple{Union{Function, Type}, NamedTuple, StepRangeLen, StepRangeLen}" href="#LegendSpecFits._get_model_counts-Tuple{Union{Function, Type}, NamedTuple, StepRangeLen, StepRangeLen}"><code>LegendSpecFits._get_model_counts</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_get_model_counts(f_fit::Base.Callable,v_ml::NamedTuple,bin_centers::StepRangeLen,bin_widths::StepRangeLen)</code></pre><p>aux. function to get modelled peakshape based on  histogram binning and best-fit parameter</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/gof.jl#L18-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits._prepare_data-Tuple{StatsBase.Histogram{&lt;:Real, 1}}" href="#LegendSpecFits._prepare_data-Tuple{StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits._prepare_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_prepare_data(h::Histogram{&lt;:Real,1})</code></pre><p>aux. function to convert histogram data into bin edges, bin width and bin counts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/gof.jl#L4-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_background_peakshape-NTuple{5, Real}" href="#LegendSpecFits.aoe_compton_background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.aoe_compton_background_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aoe_compton_background_peakshape(
    x::Real, Œº::Real, œÉ::Real,
    background::Real, Œ¥::Real
)</code></pre><p>Describes the background shape of a typical A/E Compton peak in a detector as a step like background for MSE events.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L192-L199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_peakshape-NTuple{6, Real}" href="#LegendSpecFits.aoe_compton_peakshape-NTuple{6, Real}"><code>LegendSpecFits.aoe_compton_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aoe_compton_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    background::Real, Œ¥::Real
)</code></pre><p>Describes the shape of a typical A/E Compton peak in a detector as a gaussian SSE peak and a step like background for MSE events.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L161-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.aoe_compton_signal_peakshape-NTuple{4, Real}" href="#LegendSpecFits.aoe_compton_signal_peakshape-NTuple{4, Real}"><code>LegendSpecFits.aoe_compton_signal_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aoe_compton_signal_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real
)</code></pre><p>Describes the signal shape of a typical A/E Compton peak in a detector as a gaussian SSE peak.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L178-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.array_to_tuple-Tuple{AbstractArray, NamedTuple}" href="#LegendSpecFits.array_to_tuple-Tuple{AbstractArray, NamedTuple}"><code>LegendSpecFits.array_to_tuple</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">array_to_tuple(a::AbstractArray, as_nt::NamedTuple)</code></pre><p>Return a <code>NamedTuple</code> with the values of <code>a</code> in the order given by <code>fieldnames(as_nt)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L58-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.autocal_energy-Tuple{AbstractArray{&lt;:Real}}" href="#LegendSpecFits.autocal_energy-Tuple{AbstractArray{&lt;:Real}}"><code>LegendSpecFits.autocal_energy</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">autocal_energy(E_raw::AbstractArray{&lt;:Real})</code></pre><p>Compute an energy calibration from raw reconstructed energy deposition values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/auto_calibration.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.background_peakshape-NTuple{5, Real}" href="#LegendSpecFits.background_peakshape-NTuple{5, Real}"><code>LegendSpecFits.background_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">background_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    skew_fraction::Real, skew_width::Real,
)</code></pre><p>Describes the background part of the shape of a typical gamma peak in a detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L113-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.baseline_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table" href="#LegendSpecFits.baseline_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.baseline_qc</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">baseline_qc(data, qc_config)</code></pre><p>Perform simple Gaussian fits on the baseline disitrbutions for a given data set.</p><p><strong>Returns</strong></p><ul><li><code>result</code>: Namedtuple containing the cut and fit results for each baseline variable</li><li><code>report</code>: Namedtuple containing plotable objects.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/qc.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.chi2fit-Tuple{Function, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}" href="#LegendSpecFits.chi2fit-Tuple{Function, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>LegendSpecFits.chi2fit</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_chisq(x::AbstractVector{&lt;:Real},y::AbstractVector{&lt;:Real},yerr::AbstractVector{&lt;:Real}, f_fit::Function;pull_t::Vector{&lt;:NamedTuple} = fill(NamedTuple(), first(methods(f_fit)).nargs - 2), v_init::Vector = [])</code></pre><p>Least square fit with chi2 minimization</p><p><strong>Input:</strong></p><ul><li>x : x-values</li><li>y : y-values</li><li>yerr : 1 sigma uncertainty on y</li><li>f<em>fit : fit/model function. e.g. for a linear function: f</em>lin(x,p1,p2)  = p1 .* x .+ p2   </li></ul><p>The numer of fit parameter is determined with <code>first(methods(f_fit)).nargs - 2</code>. That&#39;s why it&#39;s important that f<em>fit has the synthax f(x,arg1,arg2,arg3,...) pull</em>t : pull term, a vector of NamedTuple with fields <code>mean</code> and <code>std</code>. A Gaussian pull term is added to the chi2 function to account for systematic uncertainties. If left blank, no pull term is used. v_init : initial value for fit parameter optimization. If left blank, the initial value is set to 1 or guessed roughly for all fit parameters</p><p><strong>Return:</strong></p><ul><li>result : NamedTuple with the optimized fit parameter and the fit function</li><li>report: </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/chi2fit.jl#L2-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.ctc_energy" href="#LegendSpecFits.ctc_energy"><code>LegendSpecFits.ctc_energy</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ctc_energy(e::Array{T}, qdrift::Array{T}, peak::T, window::T) where T&lt;:Real</code></pre><p>Correct for the drift time dependence of the energy by minimizing the ratio of the FWHM and the peak height of the peak around <code>peak</code> in <code>e</code> with a cut window of <code>window</code>. The drift time dependence is given by <code>qdrift</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peak`: peak position
* `window`: window size
* `fct`: correction factor
* `fwhm_before`: FWHM before correction
* `fwhm_after`: FWHM after correction
* `func`: function to correct energy
* `func_generic`: generic function to correct energy</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/ctc.jl#L26-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.cut_single_peak-Union{Tuple{T}, Tuple{Vector{T}, T, T}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.cut_single_peak-Union{Tuple{T}, Tuple{Vector{T}, T, T}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.cut_single_peak</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cut_single_peak(x::Array, min_x::Float64, max_x::Float64,; n_bins::Int=15000, relative_cut::Float64=0.5)</code></pre><p>Cut out a single peak from the array <code>x</code> between <code>min_x</code> and <code>max_x</code>. The number of bins is the number of bins to use for the histogram. The relative cut is the fraction of the maximum counts to use for the cut.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `max`: maximum position of the peak
* `low`: lower edge of the cut peak
* `high`: upper edge of the cut peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/cut.jl#L2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_combined_peak_stats-Tuple{StructArrays.StructArray}" href="#LegendSpecFits.estimate_combined_peak_stats-Tuple{StructArrays.StructArray}"><code>LegendSpecFits.estimate_combined_peak_stats</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">estimate_combined_peak_stats(peakstats::StructArray,; calib_type::Symbol=:th228)</code></pre><p>Estimate the peak position, FWHM, sigma, counts and background of a peak from a histogram.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit_combined.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_fwhm-Tuple{NamedTuple}" href="#LegendSpecFits.estimate_fwhm-Tuple{NamedTuple}"><code>LegendSpecFits.estimate_fwhm</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">estimate_fwhm(v::NamedTuple, v_err::NamedTuple)</code></pre><p>Get the FWHM of a peak from the fit parameters.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `fwhm`: the FWHM of the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit.jl#L281-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_single_peak_stats-Tuple{StatsBase.Histogram}" href="#LegendSpecFits.estimate_single_peak_stats-Tuple{StatsBase.Histogram}"><code>LegendSpecFits.estimate_single_peak_stats</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">estimate_single_peak_stats(h::Histogram, calib_type::Symbol=:th228)</code></pre><p>Estimate statistics/parameters for a single peak in the given histogram <code>h</code>.</p><p><code>h</code> must only contain a single peak. The peak should have a Gaussian-like shape. <code>calib_type</code> specifies the calibration type. Currently only <code>:th228</code> is implemented. If you want get the peak statistics for a PSD calibration, use <code>:psd</code>.</p><p><strong>Returns</strong></p><p><code>NamedTuple</code> with the fields     * <code>peak_pos</code>: estimated position of the peak (in the middle of the peak)     * <code>peak_fwhm</code>: full width at half maximum (FWHM) of the peak     * <code>peak_sigma</code>: estimated standard deviation of the peak     * <code>peak_counts</code>: estimated number of counts in the peak     * <code>mean_background</code>: estimated mean background value</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit.jl#L11-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.estimate_single_peak_stats_psd-Union{Tuple{StatsBase.Histogram{T}}, Tuple{T}} where T&lt;:Real" href="#LegendSpecFits.estimate_single_peak_stats_psd-Union{Tuple{StatsBase.Histogram{T}}, Tuple{T}} where T&lt;:Real"><code>LegendSpecFits.estimate_single_peak_stats_psd</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">estimate_single_peak_stats_psd(h::Histogram{T}) where T&lt;:Real</code></pre><p>Estimate peak parameters for a single peak in a histogram using the maximum, the FWHM and the area of the peak.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peak_pos`: Position of the peak
* `peak_fwhm`: Full width at half maximum of the peak
* `peak_sigma`: Standard deviation of the peak
* `peak_counts`: Counts of the peak
* `mean_background`: Mean background of the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoefit.jl#L17-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.ex_gauss_pdf-NTuple{4, Real}" href="#LegendSpecFits.ex_gauss_pdf-NTuple{4, Real}"><code>LegendSpecFits.ex_gauss_pdf</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ex_gauss_pdf(x::Real, Œº::Real, œÉ::Real, Œ∏::Real)</code></pre><p>The PDF of an <a href="https://en.wikipedia.org/wiki/Exponentially_modified_Gaussian_distribution">Exponentially modified Gaussian distribution</a> with Gaussian parameters <code>Œº</code>, <code>œÉ</code> and exponential scale <code>Œ∏</code> at <code>x</code>.</p><p>It is the PDF of the distribution that descibes the random process <code>rand(Normal(Œº, œÉ)) + rand(Exponential(Œ∏))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L11-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.ex_step_gauss-NTuple{5, Real}" href="#LegendSpecFits.ex_step_gauss-NTuple{5, Real}"><code>LegendSpecFits.ex_step_gauss</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ex_step_gauss(x::Real, l::Real, k::Real, t::Real, d::Real)</code></pre><p>Evaluates an extended step gauss model at <code>x</code> with parameters <code>l</code>, <code>k</code>, <code>t</code> and <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L147-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.expand_vars-Tuple{NamedTuple}" href="#LegendSpecFits.expand_vars-Tuple{NamedTuple}"><code>LegendSpecFits.expand_vars</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">expand_vars(v::NamedTuple)::StructArray</code></pre><p>Expand all fields in <code>v</code> (scalars or arrays) to same array size and return a <code>StructArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.exponential_decay-NTuple{4, Real}" href="#LegendSpecFits.exponential_decay-NTuple{4, Real}"><code>LegendSpecFits.exponential_decay</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">exponential_decay(x::Real, amplitude::Real, decay::Real, offset::Real)</code></pre><p>Evaluates an exponential decay function at <code>x</code> with parameters <code>amplitude</code>, <code>decay</code> and <code>offset</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.f_optimize_ctc-NTuple{4, Any}" href="#LegendSpecFits.f_optimize_ctc-NTuple{4, Any}"><code>LegendSpecFits.f_optimize_ctc</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">f_optimize_ctc(fct, e, qdrift, bin_width)</code></pre><p>Calculate the ratio of the FWHM and the peak height of the peak around <code>peak</code> in <code>e</code> with a cut window of <code>window</code>. The drift time dependence is given by <code>e_ctc</code> = <code>e</code> + <code>fct</code> * <code>qdrift</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `fwhm / p_height`: FWHM of the peak divided by peak height</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/ctc.jl#L2-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_aoe_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s3&quot;&lt;:Real, U})" href="#LegendSpecFits.fit_aoe_compton-Union{Tuple{T}, Tuple{Vector{&lt;:StatsBase.Histogram}, StructArrays.StructArray, Array{T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s3&quot;&lt;:Real, U})"><code>LegendSpecFits.fit_aoe_compton</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_aoe_compton(peakhists::Array, peakstats::StructArray, compton_bands::Array{T}) where T&lt;:Real</code></pre><p>Fit the A/E Compton bands using the <code>f_aoe_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: Dict of NamedTuples of the fit results containing values and errors for each compton band
* `report`: Dict of NamedTuples of the fit report which can be plotted for each compton band</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoefit.jl#L181-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_aoe_corrections-Tuple{Array{&lt;:Union{Unitful.Quantity{var&quot;#s526&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s526&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s526&quot;&lt;:Real, U}}, Array{&lt;:Real}, Array{&lt;:Real}}" href="#LegendSpecFits.fit_aoe_corrections-Tuple{Array{&lt;:Union{Unitful.Quantity{var&quot;#s526&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s526&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s526&quot;&lt;:Real, U}}, Array{&lt;:Real}, Array{&lt;:Real}}"><code>LegendSpecFits.fit_aoe_corrections</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>fit<em>aoe</em>corrections(e::Array{&lt;:Unitful.Energy{&lt;:Real}}, Œº::Array{&lt;:Real}, œÉ::Array{&lt;:Real})</p><p>Fit the corrections for the AoE value of the detector.</p><p><strong>Returns</strong></p><ul><li><code>e</code>: Energy values</li><li><code>Œº</code>: Mean values</li><li><code>œÉ</code>: Sigma values</li><li><code>Œº_scs</code>: Fit result for the mean values</li><li><code>f_Œº_scs</code>: Fit function for the mean values</li><li><code>œÉ_scs</code>: Fit result for the sigma values</li><li><code>f_œÉ_scs</code>: Fit function for the sigma values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L5-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_calibration-Tuple{Int64, AbstractVector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, AbstractVector{&lt;:Unitful.Quantity}}" href="#LegendSpecFits.fit_calibration-Tuple{Int64, AbstractVector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, AbstractVector{&lt;:Unitful.Quantity}}"><code>LegendSpecFits.fit_calibration</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_calibration(n_poly::Int, ¬µ::AbstractVector{&lt;:Union{Real,Measurement{&lt;:Real}}}, peaks::AbstractVector{&lt;:Union{Real,Measurement{&lt;:Real}}}; pull_t::Vector{&lt;:NamedTuple}=fill(NamedTuple(), n_poly+1), v_init::Vector = [], uncertainty::Bool=true )</code></pre><p>Fit the calibration lines with polynomial function of n<em>poly order     n</em>poly == 1 -&gt; linear function     n_poly == 2 -&gt; quadratic function</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple with the following fields
    * `par`: best-fit parameters
    * `gof`: godness of fit
* `report`:</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/fit_calibration.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_enc_sigmas-Union{Tuple{T}, Tuple{Matrix{T}, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, T, T, Int64, T}} where T&lt;:Real" href="#LegendSpecFits.fit_enc_sigmas-Union{Tuple{T}, Tuple{Matrix{T}, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, T, T, Int64, T}} where T&lt;:Real"><code>LegendSpecFits.fit_enc_sigmas</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_enc_sigmas(enc_grid::Matrix{T}, enc_grid_rt::StepRangeLen{Quantity{&lt;:T}, Base.TwicePrecision{Quantity{&lt;:T}}, Base.TwicePrecision{Quantity{&lt;:T}}, Int64}, min_enc::T, max_enc::T, nbins::Int64, rel_cut_fit::T) where T&lt;:Real</code></pre><p>Fit the ENC values in <code>enc_grid</code> for each RT in <code>enc_grid_rt</code> with a Gaussian and return the optimal RT and the corresponding ENC value.</p><p><strong>Arguments</strong></p><ul><li><code>enc_grid</code>: 2D array of ENC values for each RT in <code>enc_grid_rt</code></li><li><code>enc_grid_rt</code>: 1D array of RT values for which the ENC values in <code>enc_grid</code> are calculated</li><li><code>min_enc</code>: minimum ENC value to consider for the fit</li><li><code>max_enc</code>: maximum ENC value to consider for the fit</li><li><code>nbins</code>: number of bins to use for the histogram of ENC values</li><li><code>rel_cut_fit</code>: relative cut value to use for the fit</li></ul><p><strong>Returns</strong></p><ul><li><code>rt</code>: optimal RT value</li><li><code>min_enc</code>: corresponding ENC value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/filter_optimization.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_fwhm-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s5&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s5&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s5&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s3&quot;&lt;:Real, U}}}" href="#LegendSpecFits.fit_fwhm-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s5&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s5&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s5&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s3&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s3&quot;&lt;:Real, U}}}"><code>LegendSpecFits.fit_fwhm</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fitFWHM(fit_fwhm(peaks::Vector{T}, fwhm::Vector{T}) where T&lt;:Real</code></pre><p>Fit the FWHM of the peaks to a quadratic function.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `qbb`: the FWHM at 2039 keV
* `err`: the uncertainties of the fit parameters
* `v`: the fit result parameters
* `f_fit`: the fitted function</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/fwhm.jl#L6-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_fwhm_ft_fep-Union{Tuple{T}, Tuple{Matrix, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, Int64, T}} where T&lt;:Real" href="#LegendSpecFits.fit_fwhm_ft_fep-Union{Tuple{T}, Tuple{Matrix, StepRangeLen{Unitful.Quantity{&lt;:T}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Base.TwicePrecision{Unitful.Quantity{&lt;:T}}, Int64}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, T, T, Int64, T}} where T&lt;:Real"><code>LegendSpecFits.fit_fwhm_ft_fep</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>fit<em>fwhm</em>ft<em>fep(e</em>grid::Matrix, e<em>grid</em>ft::StepRangeLen{Quantity{&lt;:T}, Base.TwicePrecision{Quantity{&lt;:T}}, Base.TwicePrecision{Quantity{&lt;:T}}, Int64}, rt::Unitful.RealOrRealQuantity, min<em>e::T, max</em>e::T, nbins::Int64, rel<em>cut</em>fit::T; default_ft::Quantity{T}=3.0u&quot;¬µs&quot;) where {T &lt;:Real}</p><p>Fit the FWHM values in <code>e_grid</code> for each FT in <code>e_grid_ft</code> with a Gamma Peakshape and return the optimal FT and the corresponding FWHM value. The cut values cut for each flat-top time a window for better histogramming.</p><p><strong>Arguments</strong></p><ul><li><code>e_grid</code>: 2D array of energy values for each FT in <code>e_grid_ft</code></li><li><code>e_grid_ft</code>: 1D array of FT values for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>rt</code>: RT value for which the FWHM values in <code>e_grid</code> are calculated</li><li><code>min_e</code>: minimum energy value to consider for the fit</li><li><code>max_e</code>: maximum energy value to consider for the fit</li><li><code>nbins</code>: number of bins to use for the histogram of energy values</li><li><code>rel_cut_fit</code>: relative cut value to use for the fit</li></ul><p><strong>Returns</strong></p><ul><li><code>ft</code>: optimal FT value</li><li><code>min_fwhm</code>: corresponding FWHM value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/filter_optimization.jl#L63-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_half_centered_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, T, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_half_centered_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, T, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_centered_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_half_centered_trunc_gauss(x::Array, cuts::NamedTuple{(:low, :high, :max), Tuple{Float64, Float64, Float64}})</code></pre><p>Fit a single truncated Gaussian to the data <code>x</code> between <code>cut.low</code> and <code>cut.high</code>. The peak center is fixed at <code>Œº</code> and the peak is cut in half either in the left or right half.</p><p><strong>Returns <code>report</code> and <code>result</code>` with:</strong></p><pre><code class="nohighlight hljs">* `f_fit`: fitted function
* `Œº`: mean of the Gaussian
* `Œº_err`: error of the mean
* `œÉ`: standard deviation of the Gaussian
* `œÉ_err`: error of the standard deviation
* `n`: number of counts in the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/singlefit.jl#L73-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_half_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_half_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_half_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_half_centered_trunc_gauss(x::Array, cuts::NamedTuple{(:low, :high, :max), Tuple{Float64, Float64, Float64}})</code></pre><p>Fit a single truncated Gaussian to the data <code>x</code> between <code>cut.low</code> and <code>cut.high</code>. The peak center is fixed at <code>Œº</code> and the peak is cut in half either in the left or right half.</p><p><strong>Returns <code>report</code> and <code>result</code> with:</strong></p><pre><code class="nohighlight hljs">* `f_fit`: fitted function
* `Œº`: mean of the Gaussian
* `Œº_err`: error of the mean
* `œÉ`: standard deviation of the Gaussian
* `œÉ_err`: error of the standard deviation
* `n`: number of counts in the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/singlefit.jl#L146-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_peaks-Tuple{Array, StructArrays.StructArray, Vector}" href="#LegendSpecFits.fit_peaks-Tuple{Array, StructArrays.StructArray, Vector}"><code>LegendSpecFits.fit_peaks</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_peaks(peakhists::Array, peakstats::StructArray, th228_lines::Array,; calib_type::Symbol=:th228, uncertainty::Bool=true, low_e_tail::Bool=true)</code></pre><p>Perform a fit of the peakshape to the data in <code>peakhists</code> using the initial values in <code>peakstats</code> to the calibration lines in <code>th228_lines</code>. </p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peak_fit_plots`: array of plots of the peak fits
* `return_vals`: dictionary of the fit results</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit.jl#L97-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_peaks_combined-Tuple{Array, StructArrays.StructArray, Array}" href="#LegendSpecFits.fit_peaks_combined-Tuple{Array, StructArrays.StructArray, Array}"><code>LegendSpecFits.fit_peaks_combined</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_peaks_combined(peakhists::Array, peakstats::StructArray, th228_lines::Array{T},; calib_type::Symbol=:th228, uncertainty::Bool=true, fixed_position::Bool=false) where T&lt;:Real</code></pre><p>Fit the peaks of a histogram to a combined peakshape function while sharring parameters between peaks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit_combined.jl#L59-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_sg_wl-Tuple{NamedTuple{(:dep, :sep)}, StepRangeLen, PropDicts.PropDict}" href="#LegendSpecFits.fit_sg_wl-Tuple{NamedTuple{(:dep, :sep)}, StepRangeLen, PropDicts.PropDict}"><code>LegendSpecFits.fit_sg_wl</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_sg_wl(dep_sep_data, a_grid_wl_sg, optimization_config)</code></pre><p>Fit the SG window length for the SEP data and return the optimal window length and the corresponding survival fraction.</p><p><strong>Arguments</strong></p><ul><li><code>dep_sep_data</code>: NamedTuple with the DEP and SEP data</li><li><code>a_grid_wl_sg</code>: range of window lengths to sweep through</li><li><code>optimization_config</code>: configuration dictionary</li></ul><p><strong>Returns</strong></p><ul><li><code>result</code>: optimal window length and corresponding survival fraction</li><li><code>report</code>: report with all window lengths and survival fractions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/filter_optimization.jl#L155-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_aoe_compton-Tuple{StatsBase.Histogram, NamedTuple}" href="#LegendSpecFits.fit_single_aoe_compton-Tuple{StatsBase.Histogram, NamedTuple}"><code>LegendSpecFits.fit_single_aoe_compton</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_single_aoe_compton(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background, :Œº, :œÉ), NTuple{7, T}}; uncertainty::Bool=true) where T&lt;:Real</code></pre><p>Perform a fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>f_aoe_compton</code> function consisting of a gaussian SSE peak and a step like background for MSE events.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoefit.jl#L219-L227">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_peak_th228-Union{Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, mean_background::T, mean_background_step::T, mean_background_std::T}}} where T&lt;:Real" href="#LegendSpecFits.fit_single_peak_th228-Union{Tuple{T}, Tuple{StatsBase.Histogram, @NamedTuple{peak_pos::T, peak_fwhm::T, peak_sigma::T, peak_counts::T, mean_background::T, mean_background_step::T, mean_background_std::T}}} where T&lt;:Real"><code>LegendSpecFits.fit_single_peak_th228</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_single_peak_th228(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background), NTuple{5, T}};, uncertainty::Bool=true, fixed_position::Bool=false, low_e_tail::Bool=true) where T&lt;:Real</code></pre><p>Perform a fit of the peakshape to the data in <code>h</code> using the initial values in <code>ps</code> while using the <code>gamma_peakshape</code> with low-E tail. Also, FWHM is calculated from the fitted peakshape with MC error propagation. The peak position can be fixed to the value in <code>ps</code> by setting <code>fixed_position=true</code>. If the low-E tail should not be fitted, it can be disabled by setting <code>low_e_tail=false</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit.jl#L152-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_single_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.fit_single_trunc_gauss-Union{Tuple{T}, Tuple{Vector{T}, @NamedTuple{low::T, high::T, max::T}}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.fit_single_trunc_gauss</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_single_trunc_gauss(x::Array, cuts::NamedTuple{(:low, :high, :max), Tuple{Float64, Float64, Float64}})</code></pre><p>Fit a single truncated Gaussian to the data <code>x</code> between <code>min_x</code> and <code>max_x</code>. Returns <code>report</code> and <code>result</code><code>with:     *</code>f<em>fit<code>: fitted function     *</code>Œº<code>: mean of the Gaussian     *</code>Œº</em>err<code>: error of the mean     *</code>œÉ<code>: standard deviation of the Gaussian     *</code>œÉ_err<code>: error of the standard deviation     *</code>n`: number of counts in the peak</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/singlefit.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.fit_subpeaks_th228-Tuple{StatsBase.Histogram, StatsBase.Histogram, Any}" href="#LegendSpecFits.fit_subpeaks_th228-Tuple{StatsBase.Histogram, StatsBase.Histogram, Any}"><code>LegendSpecFits.fit_subpeaks_th228</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit_single_peak_th228(h::Histogram, ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background), NTuple{5, T}};, uncertainty::Bool=true, fixed_position::Bool=false, low_e_tail::Bool=true) where T&lt;:Real</code></pre><p>Perform a simultaneous fit of two peaks (<code>h_survived</code> and <code>h_cut</code>) that together would form a histogram <code>h</code>, from which the result <code>h_result</code> was already determined using <code>fit_single_peak_th228</code>. Also, FWHM is calculated from the fitted peakshape with MC error propagation. The peak position can be fixed to the value in <code>ps</code> by setting <code>fixed_position=true</code>. If the low-E tail should not be fitted, it can be disabled by setting <code>low_e_tail=false</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `result`: NamedTuple of the fit results containing values and errors, in particular the signal survival fraction `sf` and the background survival frachtion `bsf`.
* `report`: NamedTuple of the fit report which can be plotted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit.jl#L328-L336">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.gamma_peakshape-NTuple{8, Real}" href="#LegendSpecFits.gamma_peakshape-NTuple{8, Real}"><code>LegendSpecFits.gamma_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gamma_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    step_amplitude::Real, skew_fraction::Real, skew_width::Real,
    background::Real
)</code></pre><p>Describes the shape of a typical gamma peak in a detector with a flat background.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L75-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.gauss_pdf-Tuple{Real, Real, Real}" href="#LegendSpecFits.gauss_pdf-Tuple{Real, Real, Real}"><code>LegendSpecFits.gauss_pdf</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LegendSpecFits.gauss_pdf(x::Real, Œº::Real, œÉ::Real)</code></pre><p>Equivalent to <code>pdf(Normal(Œº, œÉ), x)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.generate_aoe_compton_bands-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, Vector{&lt;:T}, Vector{&lt;:T}, T}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s124&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s124&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s124&quot;&lt;:Real, U})" href="#LegendSpecFits.generate_aoe_compton_bands-Union{Tuple{T}, Tuple{Vector{&lt;:Real}, Vector{&lt;:T}, Vector{&lt;:T}, T}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s124&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s124&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s124&quot;&lt;:Real, U})"><code>LegendSpecFits.generate_aoe_compton_bands</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_aoe_compton_bands(aoe::Vector{&lt;:Real}, e::Vector{&lt;:T}, compton_bands::Vector{&lt;:T}, compton_window::T) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Generate histograms for the A/E Compton bands and estimate peak parameters.  The compton bands are cutted out of the A/E spectrum and then binned using the Freedman-Diaconis Rule. For better performance the binning is only done in the area around the peak. The peak parameters are estimated using the <code>estimate_single_peak_stats_psd</code> function.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peakhists`: Array of histograms for each compton band
* `peakstats`: StructArray of peak parameters for each compton band
* `min_aoe`: Array of minimum A/E values for each compton band
* `max_aoe`: Array of maximum A/E values for each compton band
* `mean_peak_pos`: Mean peak position of all compton bands
* `std_peak_pos`: Standard deviation of the peak position of all compton bands
* `simple_pars_aoe_Œº`: Simple curve fit parameters for the peak position energy depencence
* `simple_pars_error_aoe_Œº`: Simple curve fit parameter errors for the peak position energy depencence
* `simple_pars_aoe_œÉ`: Simple curve fit parameters for the peak sigma energy depencence
* `simple_pars_error_aoe_œÉ`: Simple curve fit parameter errors for the peak sigma energy depencence</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoefit.jl#L67-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_aoe_cut-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s145&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s145&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s145&quot;&lt;:Real, U})" href="#LegendSpecFits.get_aoe_cut-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s145&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s145&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s145&quot;&lt;:Real, U})"><code>LegendSpecFits.get_aoe_cut</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_aoe_cut(aoe::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T},; dep::T=1592.53u&quot;keV&quot;, window::Vector{T}=[12.0, 10.0]u&quot;keV&quot;, dep_sf::Float64=0.9, cut_search_interval::Tuple{Quantity{&lt;:Real}, Quantity{&lt;:Real}}=(-25.0u&quot;keV^-1&quot;, 0.0u&quot;keV^-1&quot;), rtol::Float64=0.001, bin_width_window::T=3.0u&quot;keV&quot;, fixed_position::Bool=true, sigma_high_sided::Float64=NaN, uncertainty::Bool=true, maxiters::Int=200) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the AoE cut value for a given <code>dep</code> and <code>window</code> size while performing a peak fit with fixed position. The AoE cut value is determined by finding the cut value for which the number of counts after the cut is equal to <code>dep_sf</code> times the number of counts before the cut. The algorhithm utilizes a root search algorithm to find the cut value with a relative tolerance of <code>rtol</code>.</p><p><strong>Returns</strong></p><ul><li><code>cut</code>: AoE cut value</li><li><code>n0</code>: Number of counts before the cut</li><li><code>nsf</code>: Number of counts after the cut</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L133-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_centered_gaussian_window_cut-Union{Tuple{T}, Tuple{Vector{T}, T, T, Real}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}" href="#LegendSpecFits.get_centered_gaussian_window_cut-Union{Tuple{T}, Tuple{Vector{T}, T, T, Real}} where T&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}"><code>LegendSpecFits.get_centered_gaussian_window_cut</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_centered_gaussian_window_cut(x::Array, min_x::Float64, max_x::Float64, n_œÉ::Real, center::Float64=0.0, n_bins_cut::Int=500, relative_cut::Float64=0.2, left::Bool=false)</code></pre><p>Cut out a single peak from the array <code>x</code> between <code>min_x</code> and <code>max_x</code> by fitting a truncated one-sided Gaussian and extrapolating a window cut with <code>n_œÉ</code> standard deviations. The <code>center</code> and side of the fit can be specified with <code>left</code> and <code>center</code> variable.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `low_cut`: lower edge of the cut peak
* `high_cut`: upper edge of the cut peak
* `center`: center of the peak
* `œÉ`: standard deviation of the Gaussian
* `low_cut_fit`: lower edge of the cut peak from the fit
* `high_cut_fit`: upper edge of the cut peak from the fit
* `err`: error of the fit parameters</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/cut.jl#L41-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_continuum_surrival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, T, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1251&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1251&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1251&quot;&lt;:Real, U})" href="#LegendSpecFits.get_continuum_surrival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, T, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1251&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1251&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1251&quot;&lt;:Real, U})"><code>LegendSpecFits.get_continuum_surrival_fraction</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_continuum_surrival_fraction(aoe:::Vector{&lt;:Unitful.RealOrRealQuantity}, e::Vector{&lt;:T}, center::T, window::T, aoe_cut::Unitful.RealOrRealQuantity,; sigma_high_sided::Unitful.RealOrRealQuantity=NaN) where T&lt;:Unitful.Energy{&lt;:Real}</code></pre><p>Get the surrival fraction of a continuum after a AoE cut value <code>aoe_cut</code> for a given <code>center</code> and <code>window</code> size.</p><p><strong>Returns</strong></p><ul><li><code>center</code>: Center of the continuum</li><li><code>window</code>: Window size</li><li><code>n_before</code>: Number of counts before the cut</li><li><code>n_after</code>: Number of counts after the cut</li><li><code>sf</code>: Surrival fraction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L255-L266">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_distribution_transform" href="#LegendSpecFits.get_distribution_transform"><code>LegendSpecFits.get_distribution_transform</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_distribution_transform(d::Distribution, pprior::Prior)</code></pre><p>Return a <code>DistributionTransform</code> for the given <code>Distribution</code> and <code>Prior</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_friedman_diaconis_bin_width" href="#LegendSpecFits.get_friedman_diaconis_bin_width"><code>LegendSpecFits.get_friedman_diaconis_bin_width</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_friedman_diaconis_bin_width(x::AbstractArray)</code></pre><p>Return the bin width for the given data <code>x</code> using the Friedman-Diaconis rule.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, Matrix, Integer}" href="#LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, Matrix, Integer}"><code>LegendSpecFits.get_mc_value_shapes</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_mc_value_shapes(v::NamedTuple, v_err::Matrix, n::Integer)</code></pre><p>Generate <code>n</code> random samples of fit parameters using their respective best-fit values <code>v</code> and covariance matrix <code>v_err</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L79-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, NamedTuple, Integer}" href="#LegendSpecFits.get_mc_value_shapes-Tuple{NamedTuple, NamedTuple, Integer}"><code>LegendSpecFits.get_mc_value_shapes</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_mc_value_shapes(v::NamedTuple, v_err::NamedTuple, n::Integer)</code></pre><p>Return a <code>NamedTuple</code> with the same fields as <code>v</code> and <code>v_err</code> but with <code>Normal</code> distributions for each field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L69-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_n_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1250&quot;&lt;:Real, U})" href="#LegendSpecFits.get_n_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1250&quot;&lt;:Real, U})"><code>LegendSpecFits.get_n_after_aoe_cut</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_n_after_aoe_cut(aoe_cut::T, aoe::Array{T}, e::Array{T}, peak::T, window::Array{T}, bin_width::T, result_before::NamedTuple, peakstats::NamedTuple; uncertainty=true) where T&lt;:Real</code></pre><p>Get the number of counts after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size while performing a peak fit with fixed position. The number of counts is determined by fitting the peak with a pseudo prior for the peak position.</p><p><strong>Returns</strong></p><ul><li><code>n</code>: Number of counts after the cut</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L90-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_number_of_bins-Tuple{AbstractArray}" href="#LegendSpecFits.get_number_of_bins-Tuple{AbstractArray}"><code>LegendSpecFits.get_number_of_bins</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_number_of_bins(x::AbstractArray,; method::Symbol=:sqrt)</code></pre><p>Return the number of bins for the given data <code>x</code> using the given method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peak_fwhm_th228" href="#LegendSpecFits.get_peak_fwhm_th228"><code>LegendSpecFits.get_peak_fwhm_th228</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_peak_fwhm_th228(v_ml::NamedTuple, v_ml_err::NamedTuple)</code></pre><p>Get the FWHM of a peak from the fit parameters while performing a MC error propagation.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `fwhm`: the FWHM of the peak
* `fwhm_err`: the uncertainty of the FWHM of the peak</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/specfit.jl#L299-L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peak_surrival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1249&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1249&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1249&quot;&lt;:Real, U})" href="#LegendSpecFits.get_peak_surrival_fraction-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1249&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1249&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1249&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peak_surrival_fraction</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_peak_surrival_fraction(aoe::Array{T}, e::Array{T}, peak::T, window::Array{T}, aoe_cut::T,; uncertainty::Bool=true, low_e_tail::Bool=true) where T&lt;:Real</code></pre><p>Get the surrival fraction of a peak after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size whiile performing a peak fit with fixed position.</p><p><strong>Returns</strong></p><ul><li><code>peak</code>: Peak position</li><li><code>n_before</code>: Number of counts before the cut</li><li><code>n_after</code>: Number of counts after the cut</li><li><code>sf</code>: Surrival fraction</li><li><code>err</code>: Uncertainties</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L171-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peakhists_th228-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s1257&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1257&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1257&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s1259&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1259&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1259&quot;&lt;:Real, U}}, Vector{&lt;:Tuple{Union{Unitful.Quantity{var&quot;#s1261&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1261&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1261&quot;&lt;:Real, U}, Union{Unitful.Quantity{var&quot;#s1262&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1262&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1262&quot;&lt;:Real, U}}}}" href="#LegendSpecFits.get_peakhists_th228-Tuple{Vector{&lt;:Union{Unitful.Quantity{var&quot;#s1257&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1257&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1257&quot;&lt;:Real, U}}, Vector{&lt;:Union{Unitful.Quantity{var&quot;#s1259&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1259&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1259&quot;&lt;:Real, U}}, Vector{&lt;:Tuple{Union{Unitful.Quantity{var&quot;#s1261&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1261&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1261&quot;&lt;:Real, U}, Union{Unitful.Quantity{var&quot;#s1262&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1262&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1262&quot;&lt;:Real, U}}}}"><code>LegendSpecFits.get_peakhists_th228</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_peakhists_th228(e::Array, th228_lines::Array, window_sizes::Array, e_unit::String=&quot;keV&quot;, proxy_binning_peak::Float64=2103.5, proxy_binning_peak_window::Float64=10.0)</code></pre><p>Create histograms around the calibration lines and return the histograms and the peak statistics.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">* `peakhists`: array of histograms around the calibration lines
* `peakstats`: array of statistics for the calibration line fits</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/simple_calibration.jl#L85-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_peaks_surrival_fractions-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, Vector{&lt;:T}, Vector{Symbol}, Vector{&lt;:Tuple{T, T}}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s523&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s523&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s523&quot;&lt;:Real, U})" href="#LegendSpecFits.get_peaks_surrival_fractions-Union{Tuple{T}, Tuple{Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, Vector{&lt;:T}, Vector{Symbol}, Vector{&lt;:Tuple{T, T}}, Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s523&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s523&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s523&quot;&lt;:Real, U})"><code>LegendSpecFits.get_peaks_surrival_fractions</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_peaks_surrival_fractions(aoe::Array{T}, e::Array{T}, peaks::Array{T}, peak_names::Array{Symbol}, windows::Array{T}, aoe_cut::T,; uncertainty=true) where T&lt;:Real</code></pre><p>Get the surrival fraction of a peak after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size while performing a peak fit with fixed position.</p><p><strong>Return</strong></p><ul><li><code>result</code>: Dict of results for each peak</li><li><code>report</code>: Dict of reports for each peak</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L230-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_residuals-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}" href="#LegendSpecFits.get_residuals-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}"><code>LegendSpecFits.get_residuals</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">residuals(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},v_ml::NamedTuple)</code></pre><p>Calculate bin-wise residuals and normalized residuals.  Calcualte bin-wise p-value based on poisson distribution for each bin.</p><p><strong>Input:</strong></p><ul><li><code>f_fit</code>function handle of fit function (peakshape)</li><li><code>h</code> histogram of data</li><li><code>v_ml</code> best-fit parameters</li></ul><p><strong>Returns:</strong></p><ul><li><code>residuals</code> difference: model - data (histogram bin count)</li><li><code>residuals_norm</code> normalized residuals: model - data / sqrt(model)</li><li><code>p_value_binwise</code> p-value for each bin based on poisson distribution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/gof.jl#L146-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.get_sf_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1250&quot;&lt;:Real, U})" href="#LegendSpecFits.get_sf_after_aoe_cut-Union{Tuple{T}, Tuple{Union{Real, Unitful.AbstractQuantity{&lt;:Real}}, Vector{&lt;:Union{Real, Unitful.AbstractQuantity{&lt;:Real}}}, Vector{&lt;:T}, T, Vector{T}, T, NamedTuple}} where T&lt;:(Union{Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{var&quot;#s1250&quot;, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {var&quot;#s1250&quot;&lt;:Real, U})"><code>LegendSpecFits.get_sf_after_aoe_cut</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_sf_after_aoe_cut(aoe_cut::T, aoe::Array{T}, e::Array{T}, peak::T, window::Array{T}, bin_width::T, result_before::NamedTuple; uncertainty=true) where T&lt;:Real</code></pre><p>Get the survival fraction after a AoE cut value <code>aoe_cut</code> for a given <code>peak</code> and <code>window</code> size from a combined fit to the survived and cut histograms.</p><p><strong>Returns</strong></p><ul><li><code>sf</code>: Survival fraction after the cut</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L113-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.hist_loglike-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}}" href="#LegendSpecFits.hist_loglike-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}}"><code>LegendSpecFits.hist_loglike</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">hist_loglike(f_fit::Base.Callable, h::Histogram{&lt;:Real,1})</code></pre><p>Calculate the Poisson log-likelihood of a fit function <code>f_fit(x)</code> and a histogram <code>h</code>. <code>f_fit</code> must accept all values <code>x</code> on the horizontal axis of the histogram.</p><p>Currently uses a simple midpoint-rule integration of <code>f_fit</code> over the bins of <code>h</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/likelihoods.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.linear_function-Tuple{Real, Real, Real}" href="#LegendSpecFits.linear_function-Tuple{Real, Real, Real}"><code>LegendSpecFits.linear_function</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">linear_function(x::Real, slope::Real, intercept::Real)</code></pre><p>Evaluates a linear function at <code>x</code> with parameters <code>slope</code> and <code>intercept</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.lowEtail_peakshape-NTuple{6, Real}" href="#LegendSpecFits.lowEtail_peakshape-NTuple{6, Real}"><code>LegendSpecFits.lowEtail_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lowEtail_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    skew_fraction::Real, skew_width::Real,
)</code></pre><p>Describes the low-E signal tail part of the shape of a typical gamma peak in a detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L129-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.nearestSPD-Tuple{Matrix{&lt;:Real}}" href="#LegendSpecFits.nearestSPD-Tuple{Matrix{&lt;:Real}}"><code>LegendSpecFits.nearestSPD</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nearestSPD(A::Matrix{&lt;:Real})</code></pre><p>Returns the nearest positive definite matrix to A Calculation is based on matrix factorization techniques described in https://www.sciencedirect.com/science/article/pii/0024379588902236</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L138-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.p_value-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}" href="#LegendSpecFits.p_value-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}"><code>LegendSpecFits.p_value</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p_value(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},v_ml::NamedTuple)</code></pre><p>calculate p-value based on least-squares, assuming poisson uncertainty baseline method to get goodness-of-fit (gof)</p><p><strong>input:</strong></p><ul><li><code>f_fit</code>function handle of fit function (peakshape)</li><li><code>h</code> histogram of data</li><li><code>v_ml</code> best-fit parameters</li></ul><p><strong>returns:</strong></p><ul><li><code>pval</code> p-value of chi2 test</li><li><code>chi2</code> chi2 value</li><li><code>dof</code> degrees of freedom</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/gof.jl#L30-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.p_value_LogLikeRatio-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}" href="#LegendSpecFits.p_value_LogLikeRatio-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple}"><code>LegendSpecFits.p_value_LogLikeRatio</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p_value_LogLikeRatio(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},v_ml::NamedTuple)</code></pre><p>Alternative p-value via loglikelihood ratio</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/gof.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.p_value_MC-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background)}, NamedTuple}" href="#LegendSpecFits.p_value_MC-Tuple{Union{Function, Type}, StatsBase.Histogram{&lt;:Real, 1}, NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background)}, NamedTuple}"><code>LegendSpecFits.p_value_MC</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p_value_MC(f_fit::Base.Callable, h::Histogram{&lt;:Real,1},ps::NamedTuple{(:peak_pos, :peak_fwhm, :peak_sigma, :peak_counts, :mean_background)},v_ml::NamedTuple,;n_samples::Int64=1000)</code></pre><p>alternative p-value calculation via Monte Carlo sampling. <strong>Warning</strong>: computational more expensive than p<em>vaule() and p</em>value_LogLikeRatio()</p><p><strong>Input:</strong></p><ul><li><code>f_fit</code>function handle of fit function (peakshape)</li><li><code>h</code> histogram of data</li><li><code>ps</code> best-fit parameters</li><li><code>v_ml</code> best-fit parameters</li><li><code>n_samples</code> number of samples</li></ul><p><strong>Performed Steps:</strong></p><ul><li>Create n_samples randomized histograms. For each bin, samples are drawn from a Poisson distribution with Œª = model peak shape (best-fit parameter)</li><li>Each sample histogram is fit using the model function <code>f_fit</code></li><li>For each sample fit, the max. loglikelihood fit is calculated </li></ul><p><strong>Returns</strong></p><ul><li>% p value ‚Äì&gt; comparison of sample max. loglikelihood and max. loglikelihood of best-fit</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/gof.jl#L96-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.prepare_dep_peakhist-Union{Tuple{T}, Tuple{Array{T}, Unitful.Quantity{T}}} where T&lt;:Real" href="#LegendSpecFits.prepare_dep_peakhist-Union{Tuple{T}, Tuple{Array{T}, Unitful.Quantity{T}}} where T&lt;:Real"><code>LegendSpecFits.prepare_dep_peakhist</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prepare_dep_peakhist(e::Array{T}, dep::T,; relative_cut::T=0.5, n_bins_cut::Int=500) where T&lt;:Real</code></pre><p>Prepare an array of uncalibrated DEP energies for parameter extraction and calibration.</p><p><strong>Returns</strong></p><ul><li><code>result</code>: Result of the initial fit</li><li><code>report</code>: Report of the initial fit</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/aoe_calibration.jl#L64-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.pulser_cal_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table" href="#LegendSpecFits.pulser_cal_qc-Union{Tuple{Q}, Tuple{Q, PropDicts.PropDict}} where Q&lt;:TypedTables.Table"><code>LegendSpecFits.pulser_cal_qc</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pulser_cal_qc(data, pulser_config; n_pulser_identified=100)</code></pre><p>Perform simple QC cuts on the data and return the data for energy calibration.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">- pulser_idx: indices of the pulser events</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/qc.jl#L81-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.signal_peakshape-NTuple{5, Real}" href="#LegendSpecFits.signal_peakshape-NTuple{5, Real}"><code>LegendSpecFits.signal_peakshape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">signal_peakshape(
    x::Real, Œº::Real, œÉ::Real, n::Real,
    skew_fraction::Real, skew_width::Real,
)</code></pre><p>Describes the signal part of the shape of a typical gamma peak in a detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L97-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.simple_calibration" href="#LegendSpecFits.simple_calibration"><code>LegendSpecFits.simple_calibration</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">simple_calibration(e_uncal::Array, th228_lines::Array, window_size::Float64=25.0, n_bins::Int=15000, calib_type::String=&quot;th228&quot;)</code></pre><p>Perform a simple calibration for the uncalibrated energy array <code>e_uncal</code>  using the calibration type <code>calib_type</code> and the calibration lines <code>th228_lines</code>.  The window size is the size of the window around the calibration line to use for the calibration.  The number of bins is the number of bins to use for the histogram.</p><p>Returns      * <code>h_calsimple</code>: histogram of the calibrated energy array     * <code>h_uncal</code>: histogram of the uncalibrated energy array     * <code>c</code>: calibration factor     * <code>fep_guess</code>: estimated full energy peak (FEP)     * <code>peakhists</code>: array of histograms around the calibration lines     * <code>peakstats</code>: array of statistics for the calibration line fits</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/simple_calibration.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.step_gauss-Tuple{Real, Real, Real}" href="#LegendSpecFits.step_gauss-Tuple{Real, Real, Real}"><code>LegendSpecFits.step_gauss</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">step_gauss(x::Real, Œº::Real, œÉ::Real)</code></pre><p>Evaluates the convulution of a Heaviside step function and the PDF of <code>Normal(Œº, œÉ)</code> at <code>x</code>.</p><p>The result does not correspond to a PDF as it is not normalizable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/peakshapes.jl#L41-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.subhist-Tuple{StatsBase.Histogram{&lt;:Any, 1}, Tuple{Real, Real}}" href="#LegendSpecFits.subhist-Tuple{StatsBase.Histogram{&lt;:Any, 1}, Tuple{Real, Real}}"><code>LegendSpecFits.subhist</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">subhist(h::Histogram, r::Tuple{&lt;:Real,&lt;:Real})</code></pre><p>Return a new <code>Histogram</code> with the bins in the range <code>r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.tuple_to_array-Tuple{NamedTuple}" href="#LegendSpecFits.tuple_to_array-Tuple{NamedTuple}"><code>LegendSpecFits.tuple_to_array</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tuple_to_array(nt::NamedTuple, fields::Vector{Symbol})</code></pre><p>Return an array with the values of the fields in <code>nt</code> in the order given by <code>fields</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/utils.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LegendSpecFits.weibull_from_mx" href="#LegendSpecFits.weibull_from_mx"><code>LegendSpecFits.weibull_from_mx</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">weibull_from_mx(m::Real, x::Real, p_x::Real = 0.6827)::Weibull</code></pre><p>Construct a Weibull distribution with a given median <code>m</code> and a given <code>p_x</code>-quantile <code>x</code>.</p><p>Useful to construct priors for positive quantities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/legend-exp/LegendSpecFits.jl/blob/7cfada822c153aa000576f292193bffec3bd1195/src/priors.jl#L4-L11">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">¬´ Home</a><a class="docs-footer-nextpage" href="../LICENSE/">LICENSE ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 24 May 2024 09:01">Friday 24 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
